<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="canvas <canvas> 是 HTML5 新增的元素，可用于通过使用JavaScript中的脚本来绘制图形，创建动画。<canvas> 最早由Apple引入WebKit.
我们可以使用<canvas>标签来定义一个canvas元素。
 canvas元素默认具有高宽
width： 300px
height：150px
 1.整体API 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111  1."><meta property="og:title" content="canvas"><meta property="og:description" content="canvas <canvas> 是 HTML5 新增的元素，可用于通过使用JavaScript中的脚本来绘制图形，创建动画。<canvas> 最早由Apple引入WebKit.
我们可以使用<canvas>标签来定义一个canvas元素。
 canvas元素默认具有高宽
width： 300px
height：150px
 1.整体API 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111  1."><meta property="og:type" content="website"><meta property="og:image" content="https://jieye-ericx.github.io/icon.png"><meta property="og:url" content="https://jieye-ericx.github.io/Canvas/"><meta property="og:width" content="200"><meta property="og:height" content="200"><meta name=twitter:card content="summary"><meta name=twitter:title content="canvas"><meta name=twitter:description content="canvas <canvas> 是 HTML5 新增的元素，可用于通过使用JavaScript中的脚本来绘制图形，创建动画。<canvas> 最早由Apple引入WebKit.
我们可以使用<canvas>标签来定义一个canvas元素。
 canvas元素默认具有高宽
width： 300px
height：150px
 1.整体API 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111  1."><meta name=twitter:image content="https://jieye-ericx.github.io/icon.png"><title>canvas</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://jieye-ericx.github.io//icon.png><link href=https://jieye-ericx.github.io/styles.80333fa2099c0bee674efa435fde378c.min.css rel=stylesheet><link href=https://jieye-ericx.github.io/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://jieye-ericx.github.io/js/darkmode.48459b7116d092b4e98d2cab704cad80.min.js></script>
<script src=https://jieye-ericx.github.io/js/util.00639692264b21bc3ee219733d38a8be.min.js></script>
<link rel=preload href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css as=style onload='this.onload=null,this.rel="stylesheet"' integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/@floating-ui/core@1.2.1></script>
<script src=https://cdn.jsdelivr.net/npm/@floating-ui/dom@1.2.1></script>
<script defer src=https://jieye-ericx.github.io/js/popover.aa9bc99c7c38d3ae9538f218f1416adb.min.js></script>
<script defer src=https://jieye-ericx.github.io/js/code-title.ce4a43f09239a9efb48fee342e8ef2df.min.js></script>
<script defer src=https://jieye-ericx.github.io/js/clipboard.2913da76d3cb21c5deaa4bae7da38c9f.min.js></script>
<script defer src=https://jieye-ericx.github.io/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const SEARCH_ENABLED=!1,LATEX_ENABLED=!0,PRODUCTION=!0,BASE_URL="https://jieye-ericx.github.io/",fetchData=Promise.all([fetch("https://jieye-ericx.github.io/indices/linkIndex.a91535da5bc472c24479fcf5acf89c4d.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://jieye-ericx.github.io/indices/contentIndex.1dd2d39bdc2ec3b29401ee54b4e423a9.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://jieye-ericx.github.io",!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://jieye-ericx.github.io",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}var i=document.getElementsByClassName("mermaid");i.length>0&&import("https://unpkg.com/mermaid@9/dist/mermaid.esm.min.mjs").then(e=>{e.default.init()});function a(n){const e=n.target,t=e.className.split(" "),s=t.includes("broken"),o=t.includes("internal-link");plausible("Link Click",{props:{href:e.href,broken:s,internal:o,graph:!1}})}const r=document.querySelectorAll("a");for(link of r)link.className.includes("root-title")&&link.addEventListener("click",a,{once:!0})},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'’':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/jieye-ericx.github.io\/js\/router.d6fe6bd821db9ea97f9aeefae814d8e7.min.js"
    attachSPARouting(init, render)
  </script><script defer data-domain=jieye-ericx.github.io src=https://plausible.io/js/script.js></script>
<script>window.plausible=window.plausible||function(){(window.plausible.q=window.plausible.q||[]).push(arguments)}</script></head><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://jieye-ericx.github.io/js/full-text-search.e6e2e0c213187ca0c703d6e2c7a77fcd.min.js></script><div class=singlePage><header><h1 id=page-title><a class=root-title href=https://jieye-ericx.github.io/>jieye の 数字花园</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>canvas</h1><p class=meta>Last updated
May 17, 2022</p><ul class=tags></ul><aside class=mainTOC><details><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#1整体api>1.整体API</a></li><li><a href=#2不支持的浏览器>2.不支持的浏览器</a></li><li><a href=#canvas属性>&lt;canvas>属性</a></li><li><a href=#渲染上下文>渲染上下文</a></li><li><a href=#绘制矩形>绘制矩形</a><ol><li></li></ol></li></ol><ol><li><a href=#渐变>渐变</a><ol><li><a href=#线性渐变>线性渐变</a></li><li><a href=#径向渐变>径向渐变</a></li></ol></li></ol><ol><li><a href=#绘制>绘制</a><ol><li><a href=#measuretext>measureText</a></li><li><a href=#中文本水平垂直居中>中文本水平垂直居中</a></li><li><a href=#文本阴影盒阴影>文本阴影&盒阴影</a></li></ol></li></ol><ol><li><a href=#得到场景像素数据>得到场景像素数据</a></li><li><a href=#创建一个imagedata对象>创建一个<code>ImageData</code>对象</a></li><li><a href=#在场景中写入像素数据>在场景中写入像素数据</a></li><li><a href=#操作单个像素行与列>操作单个像素（行与列）</a></li></ol></nav></details></aside><a href=#canvas><h1 id=canvas><span class=hanchor arialabel=Anchor># </span>canvas</h1></a><p><code>&lt;canvas></code> 是 HTML5 新增的元素，可用于通过使用JavaScript中的脚本来绘制图形，创建动画。<code>&lt;canvas> </code>最早由Apple引入WebKit.<br>我们可以使用&lt;canvas>标签来定义一个canvas元素。</p><blockquote><p>canvas元素默认具有高宽<br>width： 300px<br>height：150px</p></blockquote><a href=#1整体api><h2 id=1整体api><span class=hanchor arialabel=Anchor># </span>1.整体API</h2></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=mf>1.</span><span class=nx>注意点</span>
</span></span><span class=line><span class=cl><span class=o>---</span><span class=nx>canvas图像的渲染有别于html图像的渲染</span><span class=err>，</span>
</span></span><span class=line><span class=cl>		<span class=nx>canvas的渲染极快</span><span class=err>，</span><span class=nx>不会出现代码覆盖后延迟渲染的问题</span>
</span></span><span class=line><span class=cl>		<span class=nx>写canvas代码一定要具有同步思想</span>
</span></span><span class=line><span class=cl><span class=o>---</span><span class=nx>在获取上下文时</span><span class=err>，</span><span class=nx>一定要先判断</span>
</span></span><span class=line><span class=cl><span class=o>---</span><span class=nx>画布高宽的问题</span>
</span></span><span class=line><span class=cl>	<span class=nx>画布默认高宽300</span><span class=o>*</span><span class=mi>150</span>
</span></span><span class=line><span class=cl>	<span class=nx>切记一定要使用html的attribute的形式来定义画布的宽高</span>
</span></span><span class=line><span class=cl>	<span class=nx>通过css形式定义会缩放画布内的图像</span>
</span></span><span class=line><span class=cl><span class=o>---</span><span class=nx>绘制矩形的问题</span>
</span></span><span class=line><span class=cl>	<span class=nx>a</span><span class=p>.</span><span class=nx>边框宽度的问题</span><span class=err>，</span><span class=nx>边框宽度是在偏移量上下分别渲染一半</span><span class=err>，</span><span class=nx>可能会出现小数边框</span><span class=err>，</span>
</span></span><span class=line><span class=cl>		<span class=nx>一旦出现小数边框都会向上取整</span>
</span></span><span class=line><span class=cl>	<span class=nx>b</span><span class=p>.</span><span class=nx>canvas的api只支持一种图像的直接渲染</span><span class=err>：</span><span class=nx>矩形</span>
</span></span><span class=line><span class=cl><span class=o>---</span><span class=nx>我们没法使用选择器来选到canvas中的图像</span>
</span></span><span class=line><span class=cl><span class=mf>2.</span><span class=nx>画布api</span>
</span></span><span class=line><span class=cl>	<span class=nx>oc</span><span class=p>.</span><span class=nx>getContext</span><span class=p>(</span><span class=s2>&#34;2d&#34;</span><span class=p>)</span><span class=o>:</span><span class=nx>获取画布的2d上下文</span>
</span></span><span class=line><span class=cl>	<span class=nx>oc</span><span class=p>.</span><span class=nx>width</span><span class=o>:</span><span class=nx>画布在横向上css像素的个数</span>
</span></span><span class=line><span class=cl>	<span class=nx>oc</span><span class=p>.</span><span class=nx>height</span><span class=o>:</span><span class=nx>画布在纵向上css像素的个数</span>
</span></span><span class=line><span class=cl>	<span class=nx>oc</span><span class=p>.</span><span class=nx>toDataUrl</span><span class=p>()</span><span class=o>:</span><span class=nx>拿到画布的图片地址</span>
</span></span><span class=line><span class=cl><span class=mf>3.</span><span class=nx>上下文api</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>fillRect</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span><span class=nx>y</span><span class=p>,</span><span class=nx>w</span><span class=p>,</span><span class=nx>h</span><span class=p>)</span><span class=o>:</span><span class=nx>填充矩形</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>strokeRect</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span><span class=nx>ymwmh</span><span class=p>)</span><span class=o>:</span><span class=nx>带边框的矩形</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>clearRect</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=nx>oc</span><span class=p>.</span><span class=nx>width</span><span class=p>,</span><span class=nx>oc</span><span class=p>.</span><span class=nx>height</span><span class=p>)</span><span class=o>:</span><span class=nx>清除整个画布</span><span class=p>,</span><span class=nx>注意原点的位置</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>fillStyle</span><span class=o>:</span><span class=nx>填充颜色</span>
</span></span><span class=line><span class=cl>		<span class=nx>背景fillStyle的值可以是createPattern</span><span class=p>(</span><span class=nx>image</span><span class=p>,</span> <span class=nx>repetition</span><span class=p>)</span><span class=nx>返回的对象</span>
</span></span><span class=line><span class=cl>		<span class=nx>线性渐变fillStyle的值可以是createLinearGradient</span><span class=p>(</span><span class=nx>x1</span><span class=p>,</span> <span class=nx>y1</span><span class=p>,</span> <span class=nx>x2</span><span class=p>,</span> <span class=nx>y2</span><span class=p>))</span><span class=nx>返回的对象</span>
</span></span><span class=line><span class=cl>				<span class=nx>addColorStop</span><span class=p>(</span><span class=nx>position</span><span class=p>,</span> <span class=nx>color</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			<span class=nx>径向渐变fillStyle的值可以是createRadialGradient</span><span class=p>(</span><span class=nx>x1</span><span class=p>,</span> <span class=nx>y1</span><span class=p>,</span> <span class=nx>r1</span><span class=p>,</span> <span class=nx>x2</span><span class=p>,</span> <span class=nx>y2</span><span class=p>,</span> <span class=nx>r2</span><span class=p>)</span><span class=nx>返回的对象</span>
</span></span><span class=line><span class=cl>				<span class=nx>addColorStop</span><span class=p>(</span><span class=nx>position</span><span class=p>,</span> <span class=nx>color</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>strokeStyle</span><span class=o>:</span><span class=nx>线条颜色</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>lineWidth</span><span class=err>：</span><span class=nx>线条宽度</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>lineCap</span><span class=err>：</span><span class=nx>线条两端的展现形式</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>lineJoin</span><span class=err>：</span><span class=nx>线条连接处的展现形式</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>moveTo</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span><span class=nx>y</span><span class=p>)</span><span class=o>:</span><span class=nx>将画笔抬起点到x</span><span class=err>，</span><span class=nx>y处</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>lineTo</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span><span class=nx>y</span><span class=p>)</span><span class=o>:</span><span class=nx>将画笔移到x</span><span class=err>，</span><span class=nx>y处</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>rect</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span><span class=nx>y</span><span class=p>,</span><span class=nx>w</span><span class=p>,</span><span class=nx>h</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>arc</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span><span class=nx>y</span><span class=p>,</span><span class=nx>r</span><span class=p>,</span><span class=nx>degS</span><span class=p>,</span><span class=nx>degE</span><span class=p>,</span><span class=nx>dir</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>arcTo</span><span class=p>(</span><span class=nx>x1</span><span class=p>,</span><span class=nx>y1</span><span class=p>,</span><span class=nx>x2</span><span class=p>,</span><span class=nx>y2</span><span class=p>,</span><span class=nx>r</span><span class=p>)</span><span class=o>:</span><span class=mi>2</span><span class=nx>个坐标</span><span class=err>，</span><span class=nx>一个半径</span>
</span></span><span class=line><span class=cl>		<span class=nx>结合moveTo</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span><span class=nx>y</span><span class=p>)</span><span class=nx>方法使用</span><span class=err>，</span>
</span></span><span class=line><span class=cl>		<span class=nx>x</span><span class=p>,</span><span class=nx>y</span><span class=o>:</span><span class=nx>起始点</span>
</span></span><span class=line><span class=cl>		<span class=nx>x1</span><span class=p>,</span><span class=nx>y1</span><span class=err>：</span><span class=nx>控制点</span>
</span></span><span class=line><span class=cl>		<span class=nx>x2</span><span class=p>,</span><span class=nx>y2</span><span class=err>：</span><span class=nx>结束点</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>quadraticCurveTo</span><span class=p>(</span><span class=nx>x1</span><span class=p>,</span><span class=nx>y1</span><span class=p>,</span><span class=nx>x2</span><span class=p>,</span><span class=nx>y2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>结合moveTo</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span><span class=nx>y</span><span class=p>)</span><span class=nx>方法使用</span><span class=err>，</span>
</span></span><span class=line><span class=cl>		<span class=nx>x</span><span class=p>,</span><span class=nx>y</span><span class=o>:</span><span class=nx>起始点</span>
</span></span><span class=line><span class=cl>		<span class=nx>x1</span><span class=p>,</span><span class=nx>y1</span><span class=err>：</span><span class=nx>控制点</span>
</span></span><span class=line><span class=cl>		<span class=nx>x2</span><span class=p>,</span><span class=nx>y2</span><span class=err>：</span><span class=nx>结束点</span>
</span></span><span class=line><span class=cl>		<span class=nx>必须经过起点和终点</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>bezierCurveTo</span><span class=p>(</span><span class=nx>x1</span><span class=p>,</span> <span class=nx>y1</span><span class=p>,</span> <span class=nx>x2</span><span class=p>,</span> <span class=nx>y2</span><span class=p>,</span> <span class=nx>x3</span><span class=p>,</span> <span class=nx>y3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>结合moveTo</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span><span class=nx>y</span><span class=p>)</span><span class=nx>方法使用</span><span class=err>，</span>
</span></span><span class=line><span class=cl>		<span class=nx>x</span><span class=p>,</span><span class=nx>y</span><span class=o>:</span><span class=nx>起始点</span>
</span></span><span class=line><span class=cl>		<span class=nx>x1</span><span class=p>,</span><span class=nx>y1</span><span class=err>：</span><span class=nx>控制点</span>
</span></span><span class=line><span class=cl>		<span class=nx>x2</span><span class=p>,</span><span class=nx>y2</span><span class=err>：</span><span class=nx>控制点</span>
</span></span><span class=line><span class=cl>		<span class=nx>x3</span><span class=err>，</span><span class=nx>y3</span><span class=err>：</span><span class=nx>结束点</span>
</span></span><span class=line><span class=cl>		<span class=nx>必须经过起点和终点</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>fill</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>stroke</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>beginpath</span><span class=p>()</span><span class=o>:</span><span class=nx>清除路径容器</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>closepath</span><span class=p>()</span><span class=o>:</span><span class=nx>闭合路径</span>
</span></span><span class=line><span class=cl>		<span class=nx>fill自动闭合</span>
</span></span><span class=line><span class=cl>		<span class=nx>stroke需要手动闭合</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>save</span><span class=p>()</span>
</span></span><span class=line><span class=cl>		<span class=nx>将画布当前状态</span><span class=p>(</span><span class=nx>样式相关</span> <span class=nx>变换相关</span><span class=p>)</span><span class=nx>压入到样式栈中</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>restore</span><span class=p>()</span>
</span></span><span class=line><span class=cl>		<span class=nx>将样式栈中栈顶的元素弹到样式容器中</span>
</span></span><span class=line><span class=cl>		<span class=nx>图像最终渲染依赖于样式容器</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>translate</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span><span class=nx>y</span><span class=p>)</span><span class=o>:</span><span class=nx>将原点按当前坐标轴位移x</span><span class=err>，</span><span class=nx>y个单位</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>rotate</span><span class=p>(</span><span class=nx>弧度</span><span class=p>)</span><span class=o>:</span><span class=nx>将坐标轴按顺时针方向进行旋转</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>scale</span><span class=p>(</span><span class=nx>因子</span><span class=p>)</span><span class=o>:</span>
</span></span><span class=line><span class=cl>		<span class=nx>放大</span><span class=err>：</span><span class=nx>放大画布</span><span class=err>，</span><span class=nx>画布中的一个css像素所占据的物理面积变大</span><span class=err>，</span><span class=nx>画布中包含的css像素的个数变少</span>
</span></span><span class=line><span class=cl>			<span class=nx>画布中图像所包含的css像素的个数不变</span>
</span></span><span class=line><span class=cl>		<span class=nx>缩小</span><span class=err>：</span><span class=nx>缩小画布</span><span class=err>，</span><span class=nx>画布中的一个css像素所占据的物理面积变小</span><span class=err>，</span><span class=nx>画布中包含的css像素的个数变多</span>
</span></span><span class=line><span class=cl>			<span class=nx>画布中图像所包含的css像素的个数不变</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>drawImage</span><span class=p>(</span><span class=nx>img</span><span class=p>,</span><span class=nx>x</span><span class=p>,</span><span class=nx>y</span><span class=p>,</span><span class=nx>w</span><span class=p>,</span><span class=nx>h</span><span class=p>)</span><span class=o>:</span><span class=nx>在canvas中引入图片一定在图片加载完成之后再去操作</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>measureText</span><span class=p>(</span><span class=s2>&#34;文本&#34;</span><span class=p>)</span><span class=o>:</span><span class=nx>返回一个持有文本渲染宽度的对象</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>fillText</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>strokeText</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>font</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>textAlign</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>textBaseline</span>
</span></span><span class=line><span class=cl>	<span class=nx>shadowOffsetX</span> <span class=o>=</span> <span class=kr>float</span>
</span></span><span class=line><span class=cl>	<span class=nx>shadowOffsetY</span> <span class=o>=</span> <span class=kr>float</span>
</span></span><span class=line><span class=cl>	<span class=nx>shadowBlur</span> <span class=o>=</span> <span class=kr>float</span>
</span></span><span class=line><span class=cl>	<span class=nx>shadowColor</span> <span class=o>=</span> <span class=nx>color</span><span class=p>(</span><span class=nx>必需项</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>getImageData</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span><span class=nx>y</span><span class=p>,</span><span class=nx>w</span><span class=p>,</span><span class=nx>h</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>ImageData对象</span>
</span></span><span class=line><span class=cl>			<span class=nx>width</span><span class=err>：</span><span class=nx>选中区域在横向上css像素的个数</span>
</span></span><span class=line><span class=cl>			<span class=nx>height</span><span class=err>：</span><span class=nx>选中区域在纵向上css像素的个数</span>
</span></span><span class=line><span class=cl>			<span class=nx>data</span><span class=o>:</span><span class=nx>数组</span>
</span></span><span class=line><span class=cl>				<span class=nx>选中区域所有像素点的rgba信息</span><span class=err>，</span><span class=nx>rgba的取值从0到255</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>putImageData</span><span class=p>(</span><span class=nx>imgdata</span><span class=p>,</span><span class=nx>x</span><span class=p>,</span><span class=nx>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>createImageData</span><span class=p>(</span><span class=nx>w</span><span class=p>,</span><span class=nx>h</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>返回的是imgdata对象</span> <span class=nx>默认像素点的信息是rgba</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>globalAlpha</span>
</span></span><span class=line><span class=cl>		<span class=nx>取值为0到1</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>globalCompositeOperation</span>
</span></span><span class=line><span class=cl>		<span class=nx>source</span><span class=o>-</span><span class=nx>over</span><span class=p>(</span><span class=nx>默认值</span><span class=p>)</span><span class=o>:</span><span class=nx>源在上面</span><span class=p>,</span><span class=nx>新的图像层级比较高</span>
</span></span><span class=line><span class=cl>		<span class=nx>source</span><span class=o>-</span><span class=k>in</span>  <span class=o>:</span><span class=nx>只留下源与目标的重叠部分</span><span class=p>(</span><span class=nx>源的那一部分</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>source</span><span class=o>-</span><span class=nx>out</span> <span class=o>:</span><span class=nx>只留下源超过目标的部分</span>
</span></span><span class=line><span class=cl>		<span class=nx>source</span><span class=o>-</span><span class=nx>atop</span><span class=o>:</span><span class=nx>砍掉源溢出的部分</span>
</span></span><span class=line><span class=cl>		<span class=nx>destination</span><span class=o>-</span><span class=nx>over</span><span class=o>:</span><span class=nx>目标在上面</span><span class=p>,</span><span class=nx>旧的图像层级比较高</span>
</span></span><span class=line><span class=cl>		<span class=nx>destination</span><span class=o>-</span><span class=k>in</span><span class=o>:</span><span class=nx>只留下源与目标的重叠部分</span><span class=p>(</span><span class=nx>目标的那一部分</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>destination</span><span class=o>-</span><span class=nx>out</span><span class=o>:</span><span class=nx>只留下目标超过源的部分</span>
</span></span><span class=line><span class=cl>		<span class=nx>destination</span><span class=o>-</span><span class=nx>atop</span><span class=o>:</span><span class=nx>砍掉目标溢出的部分</span>	
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nx>ispointinpath</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span><span class=nx>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>x</span><span class=p>,</span><span class=nx>y这个点是否在路径上</span>
</span></span><span class=line><span class=cl><span class=mf>4.</span><span class=nx>实例</span>
</span></span><span class=line><span class=cl>	<span class=nx>时钟动画</span><span class=err>：</span><span class=nx>结合了所有基础api</span>
</span></span><span class=line><span class=cl>	<span class=nx>飞鸟动画</span><span class=err>：</span><span class=nx>结合图片创建动画</span>
</span></span><span class=line><span class=cl>	<span class=nx>马赛克</span><span class=err>：</span><span class=nx>像素操作</span>
</span></span><span class=line><span class=cl>	<span class=nx>刮刮卡</span><span class=err>：</span><span class=nx>合成</span><span class=o>+</span><span class=nx>像素操作</span>	
</span></span></code></pre></td></tr></table></div></div><a href=#2不支持的浏览器><h2 id=2不支持的浏览器><span class=hanchor arialabel=Anchor># </span>2.不支持的浏览器</h2></a><p>&lt;canvas>很容易定义一些替代内容。由于某些较老的浏览器（尤其是IE9之前的IE浏览器）<br>不支持HTML元素"canvas"，<br>但在这些浏览器上你应该要给用户展示些替代内容。<br>这非常简单：我们只需要在<canvas>标签中提供替换内容就可以。<br>&mdash;>支持<canvas>的浏览器将会忽略在容器中包含的内容，并且只是正常渲染canvas。<br>&ndash;>不支持<canvas>的浏览器会显示代替内容</p><a href=#canvas属性><h2 id=canvas属性><span class=hanchor arialabel=Anchor># </span>&lt;canvas>属性</h2></a><p>&lt;canvas> 看起来和&lt;img>元素很相像，唯一的不同就是它并没有 src 和 alt 属性。实际上，&lt;canvas> 标签只有两个属性—— width和height。这些都是可选的。当没有设置宽度和高度的时候，canvas会初始化宽度为300像素和高度为150像素。</p><blockquote><p>画布的高宽<br>html属性设置width height时只影响画布本身不影画布内容<br>css属性设置width height时不但会影响画布本身的高宽，<br>还会使画布中的内容等比例缩放（缩放参照于画布默认的尺寸）</p></blockquote><a href=#渲染上下文><h2 id=渲染上下文><span class=hanchor arialabel=Anchor># </span>渲染上下文</h2></a><p>&lt;canvas> 元素只是创造了一个固定大小的画布，要想在它上面去绘制内容，我们需要找到它的渲染上下文。&lt;canvas> 元素有一个叫做 getContext() 的方法，这个方法是用来获得渲染上下文和它的绘画功能。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>var</span> <span class=nx>canvas</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;box&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>ctx</span> <span class=o>=</span> <span class=nx>canvas</span><span class=p>.</span><span class=nx>getContext</span><span class=p>(</span><span class=s1>&#39;2d&#39;</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>检查支持性</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>var</span> <span class=nx>canvas</span> <span class=o>=</span><span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;tutorial&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nx>canvas</span><span class=p>.</span><span class=nx>getContext</span><span class=p>){</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>ctx</span> <span class=o>=</span> <span class=nx>canvas</span><span class=p>.</span><span class=nx>getContext</span><span class=p>(</span><span class=s1>&#39;2d&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span> 
</span></span></code></pre></td></tr></table></div></div><a href=#绘制矩形><h2 id=绘制矩形><span class=hanchor arialabel=Anchor># </span>绘制矩形</h2></a><p>HTML中的元素canvas只支持一种原生的图形绘制：矩形。所有其他的图形的绘制都至少需要生成一条路径.</p><p>canvas提供了三种方法绘制矩形：</p><ol><li><p>绘制一个填充的矩形（填充色默认为黑色）</p><p><code>fillRect(x, y, width, height)</code></p></li><li><p>绘制一个矩形的边框（默认边框为:一像素实心黑色）</p><p><code>strokeRect(x, y, width, height)</code></p></li><li><p>清除指定矩形区域，让清除部分完全透明。</p><p><code>clearRect(x, y, width, height)</code></p></li></ol><p>x与y指定了在canvas画布上所绘制的矩形的左上角（相对于原点）的坐标。width和height设置矩形的尺寸。（存在边框的话，边框会在width上占据一个边框的宽度，height同理）</p><a href=#strokerect时边框像素渲染问题><h4 id=strokerect时边框像素渲染问题><span class=hanchor arialabel=Anchor># </span>strokeRect时，边框像素渲染问题</h4></a><p>按理渲染出的边框应该是1px的，<br>canvas在渲染矩形边框时，边框宽度是平均分在偏移位置的两侧。<br>context.strokeRect(10,10,50,50):边框会渲染在10.5 和 9.5之间,浏览器是不会让一个像素只用自己的一半的<br>相当于边框会渲染在9到11之间<br>context.strokeRect(10.5,10.5,50,50):边框会渲染在10到11之间</p><a href=#添加样式和颜色><h4 id=添加样式和颜色><span class=hanchor arialabel=Anchor># </span>添加样式和颜色</h4></a><p>fillStyle :设置图形的填充颜色。<br>strokeStyle :设置图形轮廓的颜色。<br>默认情况下，线条和填充颜色都是黑色（CSS 颜色#000000）<br>ineWidth : 这个属性设置当前绘线的粗细。属性值必须为正数。<br>描述线段宽度的数字。 0、 负数、 Infinity 和 NaN 会被忽略。<br>默认值是1.0。</p><a href=#linejoin><h4 id=linejoin><span class=hanchor arialabel=Anchor># </span>lineJoin</h4></a><p>设定线条与线条间接合处的样式（默认是 miter）<br>round : 圆角<br>bevel : 斜角<br>miter : 直角</p><a href=#绘制路径基础api><h4 id=绘制路径基础api><span class=hanchor arialabel=Anchor># </span>绘制路径基础api</h4></a><p>图形的基本元素是路径。路径是通过不同颜色和宽度的线段或曲线相连形成的不同形状的点的集合。<br>1.首先，你需要创建路径起始点。<br>2.然后你使用画图命令去画出路径<br>3.之后你把路径封闭。<br>4.一旦路径生成，你就能通过描边或填充路径区域来渲染图形。</p><a href=#beginpath><h5 id=beginpath><span class=hanchor arialabel=Anchor># </span><code>beginPath()</code></h5></a><p>新建一条路径，生成之后，图形绘制命令被指向到路径上准备生成路径。本质上，路径是由很多子路径构成，这些子路径都是在一个列表中，所有的子路径（线、弧形、等等）构成图形。而每次这个方法调用之后，列表清空重置，然后我们就可以重新绘制新的图形。</p><a href=#movetox-y><h5 id=movetox-y><span class=hanchor arialabel=Anchor># </span><code>moveTo(x, y)</code></h5></a><p>将笔触移动到指定的坐标x以及y上,当canvas初始化或者beginPath()调用后，你通常会使用moveTo()函数设置起点.</p><a href=#linetox-y><h5 id=linetox-y><span class=hanchor arialabel=Anchor># </span><code>lineTo(x, y)</code></h5></a><p>将笔触移动到指定的坐标x以及y上,绘制一条从当前位置到指定x以及y位置的直线。</p><a href=#closepath><h5 id=closepath><span class=hanchor arialabel=Anchor># </span><code>closePath()</code></h5></a><p>闭合路径之后图形绘制命令又重新指向到上下文中。闭合路径closePath(),不是必需的。这个方法会通过绘制一条从当前点到开始点的直线来闭合图形。如果图形是已经闭合了的，即当前点为开始点，该函数什么也不做<br>当你调用fill()函数时，所有没有闭合的形状都会自动闭合，所以你不需要调用closePath()函数。<br>但是调用stroke()时不会自动闭合.</p><a href=#stroke><h5 id=stroke><span class=hanchor arialabel=Anchor># </span><code>stroke()</code></h5></a><p>通过线条来绘制图形轮廓。不会自动调用closePath().</p><a href=#fill><h5 id=fill><span class=hanchor arialabel=Anchor># </span><code>fill()</code></h5></a><p>通过填充路径的内容区域生成实心的图形。自动调用closePath().</p><a href=#rectx-y-width-height><h5 id=rectx-y-width-height><span class=hanchor arialabel=Anchor># </span><code>rect(x, y, width, height)</code></h5></a><p>绘制一个左上角坐标为（x,y），宽高为width以及height的矩形。当该方法执行的时候，moveTo()方法自动设置坐标参数（0,0）。也就是说，当前笔触自动重置会默认坐标.</p><a href=#save><h5 id=save><span class=hanchor arialabel=Anchor># </span><code>save()</code></h5></a><p>是 Canvas 2D API 通过将当前状态放入栈中，保存 canvas 全部状态的方法.</p><a href=#restore><h5 id=restore><span class=hanchor arialabel=Anchor># </span><code>restore()</code></h5></a><p>是 Canvas 2D API 通过在绘图状态栈中弹出顶端的状态，将 canvas 恢复到最近的保存状态的方法。 如果没有保存状态，此方法不做任何改变。</p><a href=#linecap><h5 id=linecap><span class=hanchor arialabel=Anchor># </span><code>lineCap</code></h5></a><p>lineCap 是 Canvas 2D API 指定如何绘制每一条线段末端的属性。<br>有3个可能的值，分别是：<br>lineCap=&ldquo;butt&rdquo; :线段末端以方形结束。<br>round :线段末端以圆形结束<br>square:线段末端以方形结束，但是增加了一个宽度和线段相同，高度是线段厚度一半的矩形区域<br>默认值是 butt。</p><blockquote><p>保存到栈中的绘制状态有下面部分组成：<br>当前的变换矩阵。<br>当前的剪切区域。<br>当前的虚线列表.<br>以下属性当前的值： strokeStyle,<br>fillStyle,<br>lineWidth,<br>lineCap,<br>lineJoin…</p></blockquote><p><img src=https://jieye-ericx.github.io//20210410190325.png width=auto alt=image-20200310011745357></p><p><code>beginPath\closePath</code>很重要，不然两个三角形第二次都会生成，后生成的会覆盖前面的。</p><p><img src=https://jieye-ericx.github.io//20210410190328.png width=auto alt=image-20200310011830836></p><p><img src=https://jieye-ericx.github.io//20210410190341.png width=auto alt=image-20200310012804358></p><p>注意，颜色取决于save restore的嵌套层级，如下图save压栈，restore弹栈</p><p><img src=https://jieye-ericx.github.io//20210410190336.png width=auto alt=image-20200310012930179></p><a href=#基础模板><h5 id=基础模板><span class=hanchor arialabel=Anchor># </span>基础模板</h5></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nb>window</span><span class=p>.</span><span class=nx>onload</span><span class=o>=</span><span class=kd>function</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>	<span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>	1.路径容器
</span></span></span><span class=line><span class=cl><span class=cm>		每次调用路径api时,都会往路径容器里做登记
</span></span></span><span class=line><span class=cl><span class=cm>		调用beginPath时,清空整个路径容器
</span></span></span><span class=line><span class=cl><span class=cm>	2.样式容器
</span></span></span><span class=line><span class=cl><span class=cm>		每次调用样式api时,都会往样式容器里做登记
</span></span></span><span class=line><span class=cl><span class=cm>		调用save时候,将样式容器里的状态压入样式栈
</span></span></span><span class=line><span class=cl><span class=cm>		调用restor时候,将样式栈的栈顶状态弹出到样式样式容器里,进行覆盖
</span></span></span><span class=line><span class=cl><span class=cm>	3.样式栈
</span></span></span><span class=line><span class=cl><span class=cm>		调用save时候,将样式容器里的状态压入样式栈
</span></span></span><span class=line><span class=cl><span class=cm>		调用restore时候,将样式栈的栈顶状态弹出到样式样式容器里,进行覆盖
</span></span></span><span class=line><span class=cl><span class=cm>	*/</span>
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>canvas</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s2>&#34;#test&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span><span class=p>(</span><span class=nx>canvas</span><span class=p>.</span><span class=nx>getContext</span><span class=p>){</span>
</span></span><span class=line><span class=cl>		<span class=kd>var</span> <span class=nx>ctx</span> <span class=o>=</span> <span class=nx>canvas</span><span class=p>.</span><span class=nx>getContext</span><span class=p>(</span><span class=s2>&#34;2d&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		
</span></span><span class=line><span class=cl>		<span class=nx>ctx</span><span class=p>.</span><span class=nx>save</span><span class=p>();</span>
</span></span><span class=line><span class=cl>		<span class=c1>//关于样式的设置
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=c1>//save  restore成对出现
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=nx>ctx</span><span class=p>.</span><span class=nx>beginPath</span><span class=p>();</span>
</span></span><span class=line><span class=cl>		<span class=c1>//关于路径
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=nx>ctx</span><span class=p>.</span><span class=nx>restore</span><span class=p>();</span>
</span></span><span class=line><span class=cl>		
</span></span><span class=line><span class=cl>		
</span></span><span class=line><span class=cl>		<span class=nx>ctx</span><span class=p>.</span><span class=nx>save</span><span class=p>();</span>
</span></span><span class=line><span class=cl>		<span class=c1>//关于样式的设置
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=nx>ctx</span><span class=p>.</span><span class=nx>beginPath</span><span class=p>();</span>
</span></span><span class=line><span class=cl>		<span class=c1>//关于路径
</span></span></span><span class=line><span class=cl><span class=c1></span>		
</span></span><span class=line><span class=cl>		<span class=nx>ctx</span><span class=p>.</span><span class=nx>fill</span><span class=p>();</span>
</span></span><span class=line><span class=cl>		<span class=nx>ctx</span><span class=p>.</span><span class=nx>restore</span><span class=p>();</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><a href=#案例-签名><h5 id=案例-签名><span class=hanchor arialabel=Anchor># </span>案例 签名</h5></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE html&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>		<span class=p>&lt;</span><span class=nt>meta</span> <span class=na>charset</span><span class=o>=</span><span class=s>&#34;UTF-8&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>		<span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>		<span class=p>&lt;</span><span class=nt>style</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text/css&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>			<span class=o>*</span><span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=k>margin</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=k>padding</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=nt>body</span><span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=k>background</span><span class=p>:</span> <span class=kc>gray</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=p>#</span><span class=nn>test</span><span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=k>position</span><span class=p>:</span> <span class=kc>absolute</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=k>left</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=k>right</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=k>top</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=k>bottom</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=k>margin</span><span class=p>:</span> <span class=kc>auto</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=k>background</span><span class=p>:</span><span class=kc>white</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>		<span class=p>&lt;/</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>		<span class=p>&lt;</span><span class=nt>canvas</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;test&#34;</span> <span class=na>width</span><span class=o>=</span><span class=s>&#34;500&#34;</span> <span class=na>height</span><span class=o>=</span><span class=s>&#34;500&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>canvas</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;</span><span class=nt>script</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text/javascript&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>		
</span></span><span class=line><span class=cl>		<span class=nb>window</span><span class=p>.</span><span class=nx>onload</span><span class=o>=</span><span class=kd>function</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>			
</span></span><span class=line><span class=cl>			<span class=kd>var</span> <span class=nx>canvas</span> <span class=o>=</span><span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>&#34;test&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>			<span class=k>if</span><span class=p>(</span><span class=nx>canvas</span><span class=p>.</span><span class=nx>getContext</span><span class=p>){</span>
</span></span><span class=line><span class=cl>				<span class=kd>var</span> <span class=nx>ctx</span> <span class=o>=</span> <span class=nx>canvas</span><span class=p>.</span><span class=nx>getContext</span><span class=p>(</span><span class=s2>&#34;2d&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			
</span></span><span class=line><span class=cl>			<span class=nx>canvas</span><span class=p>.</span><span class=nx>onmousedown</span><span class=o>=</span><span class=kd>function</span><span class=p>(</span><span class=nx>ev</span><span class=p>){</span>
</span></span><span class=line><span class=cl>				<span class=nx>ev</span> <span class=o>=</span> <span class=nx>ev</span> <span class=o>||</span> <span class=nb>window</span><span class=p>.</span><span class=nx>event</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=k>if</span><span class=p>(</span><span class=nx>canvas</span><span class=p>.</span><span class=nx>setCapture</span><span class=p>){</span>
</span></span><span class=line><span class=cl>					<span class=nx>canvas</span><span class=p>.</span><span class=nx>setCapture</span><span class=p>();</span>
</span></span><span class=line><span class=cl>				<span class=p>}</span>
</span></span><span class=line><span class=cl>				<span class=nx>ctx</span><span class=p>.</span><span class=nx>beginPath</span><span class=p>();</span>
</span></span><span class=line><span class=cl>				<span class=nx>ctx</span><span class=p>.</span><span class=nx>moveTo</span><span class=p>(</span><span class=nx>ev</span><span class=p>.</span><span class=nx>clientX</span> <span class=o>-</span><span class=nx>canvas</span><span class=p>.</span><span class=nx>offsetLeft</span><span class=p>,</span><span class=nx>ev</span><span class=p>.</span><span class=nx>clientY</span> <span class=o>-</span><span class=nx>canvas</span><span class=p>.</span><span class=nx>offsetTop</span><span class=p>);</span>
</span></span><span class=line><span class=cl>				<span class=nb>document</span><span class=p>.</span><span class=nx>onmousemove</span><span class=o>=</span><span class=kd>function</span><span class=p>(</span><span class=nx>ev</span><span class=p>){</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>save</span><span class=p>();</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>strokeStyle</span><span class=o>=</span><span class=s2>&#34;pink&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>					<span class=nx>ev</span> <span class=o>=</span> <span class=nx>ev</span> <span class=o>||</span> <span class=nx>event</span><span class=p>;</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>lineTo</span><span class=p>(</span><span class=nx>ev</span><span class=p>.</span><span class=nx>clientX</span> <span class=o>-</span><span class=nx>canvas</span><span class=p>.</span><span class=nx>offsetLeft</span><span class=p>,</span><span class=nx>ev</span><span class=p>.</span><span class=nx>clientY</span> <span class=o>-</span><span class=nx>canvas</span><span class=p>.</span><span class=nx>offsetTop</span><span class=p>);</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>stroke</span><span class=p>();</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>restore</span><span class=p>();</span>
</span></span><span class=line><span class=cl>				<span class=p>}</span>
</span></span><span class=line><span class=cl>				<span class=nb>document</span><span class=p>.</span><span class=nx>onmouseup</span><span class=o>=</span><span class=kd>function</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>					<span class=nb>document</span><span class=p>.</span><span class=nx>onmousemove</span><span class=o>=</span><span class=nb>document</span><span class=p>.</span><span class=nx>onmouseup</span><span class=o>=</span><span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>					<span class=k>if</span><span class=p>(</span><span class=nb>document</span><span class=p>.</span><span class=nx>releaseCapture</span><span class=p>){</span>
</span></span><span class=line><span class=cl>						<span class=nb>document</span><span class=p>.</span><span class=nx>releaseCapture</span><span class=p>();</span>
</span></span><span class=line><span class=cl>					<span class=p>}</span>
</span></span><span class=line><span class=cl>				<span class=p>}</span>
</span></span><span class=line><span class=cl>				<span class=k>return</span> <span class=kc>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>		
</span></span><span class=line><span class=cl>	<span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><a href=#圆形><h4 id=圆形><span class=hanchor arialabel=Anchor># </span>圆形</h4></a><p>弧度的js表达式:<code>radians=(Math.PI/180)*degrees。</code></p><a href=#arcxyradiusstartangleendangleanticlockwise><h5 id=arcxyradiusstartangleendangleanticlockwise><span class=hanchor arialabel=Anchor># </span><code>arc(x,y,radius,startAngle,endAngle,anticlockwise)</code></h5></a><p>画一个以（x,y）为圆心的以radius为半径的圆弧（圆），从startAngle开始到endAngle结束，<br>按照anticlockwise给定的方向（默认为顺时针）来生成。<br>ture：逆时针<br>false:顺时针</p><ul><li>x,y为绘制圆弧所在圆上的圆心坐标</li><li>radius为半径</li><li>startAngle以及endAngle参数用弧度定义了开始以及结束的弧度。这些都是以x轴为基准</li><li>参数anticlockwise 为一个布尔值。为true时，是逆时针方向，否则顺时针方向。</li></ul><p><img src=https://jieye-ericx.github.io//20210410190355.png width=auto alt=image-20200310014732283></p><p><img src=https://jieye-ericx.github.io//20210410190400.png width=auto alt=image-20200310014748642></p><p><img src=https://jieye-ericx.github.io//20210410190405.png width=auto alt=image-20200310014801211></p><p><img src=https://jieye-ericx.github.io//20210410190409.png width=auto alt=image-20200310014815597></p><a href=#arctox1-y1-x2-y2-radius><h5 id=arctox1-y1-x2-y2-radius><span class=hanchor arialabel=Anchor># </span><code>arcTo(x1, y1, x2, y2, radius)</code></h5></a><p>根据给定的控制点和半径画一段圆弧<br>肯定会从(x1 y1) 但不一定经过(x2 y2);(x2 y2)只是控制一个方向</p><p><img src=https://jieye-ericx.github.io//20210410190413.png width=auto alt=image-20200310015243769></p><p><img src=https://jieye-ericx.github.io//20210410190420.png width=auto alt=image-20200310015302562></p><a href=#贝塞尔><h4 id=贝塞尔><span class=hanchor arialabel=Anchor># </span>贝塞尔</h4></a><p><code>quadraticCurveTo(cp1x, cp1y, x, y)</code><br>绘制二次贝塞尔曲线，cp1x,cp1y为一个控制点，x,y为结束点。<br>起始点为moveto时指定的点.<br><img src=https://jieye-ericx.github.io//20210410190429.png width=auto alt=image-20200310015430730></p><p><code>bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y)</code><br>绘制三次贝塞尔曲线，cp1x,cp1y为控制点一，cp2x,cp2y为控制点二，x,y为结束点。<br>起始点为moveto时指定的点.</p><p><img src=https://jieye-ericx.github.io//20210410190439.png width=auto alt=image-20200310015557211></p><p><img src=https://jieye-ericx.github.io//20210410190445.png width=auto alt=image-20200310015548203></p><a href=#canvas中的变换><h4 id=canvas中的变换><span class=hanchor arialabel=Anchor># </span>canvas中的变换</h4></a><a href=#translatex-y><h5 id=translatex-y><span class=hanchor arialabel=Anchor># </span><code>translate(x, y)</code></h5></a><p>我们先介绍 translate 方法，它用来移动 canvas的原点到一个不同的位置。<br>translate 方法接受两个参数。x 是左右偏移量，y 是上下偏移量，<strong>在canvas中translate是累加的.</strong></p><p><img src=https://jieye-ericx.github.io//20210410190452.png width=auto alt=image-20200310223725182></p><p><img src=https://jieye-ericx.github.io//20210410190459.png width=auto alt=image-20200310223629529></p><a href=#rotateangle><h5 id=rotateangle><span class=hanchor arialabel=Anchor># </span><code>rotate(angle)</code></h5></a><p>这个方法只接受一个参数：旋转的角度(angle)，它是顺时针方向的，以弧度为单位的值。<br>旋转的中心点始终是 canvas 的原点，如果要改变它，我们需要用到 translate 方法,<strong>在canvas中rotate是累加的</strong></p><p><img src=https://jieye-ericx.github.io//20210410190506.png width=auto alt=image-20200310223928586></p><a href=#scalex-y><h5 id=scalex-y><span class=hanchor arialabel=Anchor># </span><code>scale(x, y)</code></h5></a><p>scale 方法接受两个参数。x,y 分别是横轴和纵轴的缩放因子，它们都必须是正值。值比 1.0 小表示缩小，比 1.0 大则表示放大，值为 1.0 时什么效果都没有。<br>缩放一般我们用它来增减图形在 canvas 中的像素数目，对形状，位图进行缩小或者放大。<strong>在canvas中scale是累称的。</strong></p><blockquote><p><em>css像素是一个抽象单位</em></p><p>放大:使画布内css像素的个数变少，单个css像素所占据的实际物理尺寸变大</p><p>缩小:使画布内css像素的个数变多，单个css像素所占据的实际物理尺寸变小</p></blockquote><a href=#变换实例><h5 id=变换实例><span class=hanchor arialabel=Anchor># </span>变换实例</h5></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE html&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>charset</span><span class=o>=</span><span class=s>&#34;UTF-8&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>style</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text/css&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>*</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>margin</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>padding</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nt>html</span><span class=o>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>body</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>height</span><span class=p>:</span> <span class=mi>100</span><span class=kt>%</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>overflow</span><span class=p>:</span> <span class=kc>hidden</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nt>body</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>background</span><span class=p>:</span> <span class=kc>pink</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>#</span><span class=nn>test</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>background</span><span class=p>:</span> <span class=kc>gray</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>position</span><span class=p>:</span> <span class=kc>absolute</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>left</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>top</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>right</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>bottom</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>margin</span><span class=p>:</span> <span class=kc>auto</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>canvas</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;test&#34;</span> <span class=na>width</span><span class=o>=</span><span class=s>&#34;300&#34;</span> <span class=na>height</span><span class=o>=</span><span class=s>&#34;300&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>span</span><span class=p>&gt;</span>您的浏览器不支持画布元素 请您换成萌萌的谷歌<span class=p>&lt;/</span><span class=nt>span</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>canvas</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text/javascript&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nb>window</span><span class=p>.</span><span class=nx>onload</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>flag</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>scale</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>flagScale</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>canvas</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s2>&#34;#test&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>canvas</span><span class=p>.</span><span class=nx>getContext</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kd>var</span> <span class=nx>ctx</span> <span class=o>=</span> <span class=nx>canvas</span><span class=p>.</span><span class=nx>getContext</span><span class=p>(</span><span class=s2>&#34;2d&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nx>ctx</span><span class=p>.</span><span class=nx>save</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=nx>ctx</span><span class=p>.</span><span class=nx>translate</span><span class=p>(</span><span class=mi>150</span><span class=p>,</span> <span class=mi>150</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nx>ctx</span><span class=p>.</span><span class=nx>beginPath</span><span class=p>()</span>
</span></span><span class=line><span class=cl>      <span class=nx>ctx</span><span class=p>.</span><span class=nx>fillRect</span><span class=p>(</span><span class=o>-</span><span class=mi>50</span><span class=p>,</span> <span class=o>-</span><span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>100</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nx>ctx</span><span class=p>.</span><span class=nx>restore</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=nx>setInterval</span><span class=p>(</span><span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>flag</span><span class=o>++</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>ctx</span><span class=p>.</span><span class=nx>clearRect</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>canvas</span><span class=p>.</span><span class=nx>width</span><span class=p>,</span> <span class=nx>canvas</span><span class=p>.</span><span class=nx>height</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>ctx</span><span class=p>.</span><span class=nx>save</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=nx>ctx</span><span class=p>.</span><span class=nx>translate</span><span class=p>(</span><span class=mi>150</span><span class=p>,</span> <span class=mi>150</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>ctx</span><span class=p>.</span><span class=nx>rotate</span><span class=p>(</span><span class=nx>flag</span> <span class=o>*</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>PI</span> <span class=o>/</span> <span class=mi>180</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>scale</span> <span class=o>==</span> <span class=mi>100</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>flagScale</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=k>if</span><span class=p>(</span><span class=nx>scale</span><span class=o>==</span><span class=mi>0</span><span class=p>){</span>
</span></span><span class=line><span class=cl>          <span class=nx>flagScale</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=nx>scale</span><span class=o>+=</span><span class=nx>flagScale</span>
</span></span><span class=line><span class=cl>        <span class=nx>ctx</span><span class=p>.</span><span class=nx>scale</span><span class=p>(</span><span class=nx>scale</span><span class=o>/</span><span class=mi>50</span><span class=p>,</span><span class=nx>scale</span><span class=o>/</span><span class=mi>50</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>ctx</span><span class=p>.</span><span class=nx>beginPath</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=nx>ctx</span><span class=p>.</span><span class=nx>fillRect</span><span class=p>(</span><span class=o>-</span><span class=mi>50</span><span class=p>,</span> <span class=o>-</span><span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>100</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>ctx</span><span class=p>.</span><span class=nx>restore</span><span class=p>()</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span> <span class=mi>1000</span> <span class=o>/</span> <span class=mi>60</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><a href=#实践1-钟表><h1 id=实践1-钟表><span class=hanchor arialabel=Anchor># </span>实践1 钟表</h1></a><p>1.初始化<br>将圆心调整到画布的中间<br>由于canvas中画圆与旋转所参照的坐标系于正常坐标系有出入<br>将整个画布逆时针旋转90度<br>初始化一些样式数据<br>ctx.lineWidth = 8;<br>ctx.strokeStyle = &ldquo;black&rdquo;;<br>ctx.lineCap = &ldquo;round&rdquo;;<br>2.外层空心圆盘<br>圆盘颜色:#325FA2<br>圆盘宽度:14<br>圆盘半径:140</p><p>3.时针刻度<br>长度为20<br>宽度为8<br>外层空心圆盘与时针刻度之间的距离也为20</p><p>4.分针刻度<br>宽度为4<br>长度为3</p><p>5.时针<br>宽度为14<br>圆心外溢出80 收20</p><p>6.分针<br>宽度为10<br>圆心外溢出112 收28</p><p>7.秒针<br>颜色:D40000<br>宽度为6<br>圆心外溢出83 收30<br>&mdash;->中心实心圆盘<br>半径为10</p><p>​ &mdash;->秒针头<br>​ 96码开外半径为10的空心圆<br>​ 宽度为6</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE html&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>		<span class=p>&lt;</span><span class=nt>meta</span> <span class=na>charset</span><span class=o>=</span><span class=s>&#34;UTF-8&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>		<span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>		<span class=p>&lt;</span><span class=nt>style</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text/css&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>			<span class=o>*</span><span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=k>margin</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=k>padding</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=nt>html</span><span class=o>,</span><span class=nt>body</span><span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=k>height</span><span class=p>:</span> <span class=mi>100</span><span class=kt>%</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=k>overflow</span><span class=p>:</span> <span class=kc>hidden</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=k>background</span><span class=p>:</span> <span class=kc>pink</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=p>#</span><span class=nn>clock</span><span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=k>background</span><span class=p>:</span> <span class=kc>gray</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=k>position</span><span class=p>:</span> <span class=kc>absolute</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=k>left</span><span class=p>:</span> <span class=mi>50</span><span class=kt>%</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=k>top</span><span class=p>:</span> <span class=mi>50</span><span class=kt>%</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=k>transform</span><span class=p>:</span> <span class=nb>translate3d</span><span class=p>(</span><span class=mi>-50</span><span class=kt>%</span><span class=p>,</span><span class=mi>-50</span><span class=kt>%</span><span class=p>,</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			
</span></span><span class=line><span class=cl>			
</span></span><span class=line><span class=cl>			
</span></span><span class=line><span class=cl>		<span class=p>&lt;/</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>		<span class=p>&lt;</span><span class=nt>canvas</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;clock&#34;</span> <span class=na>width</span><span class=o>=</span><span class=s>&#34;400&#34;</span> <span class=na>height</span><span class=o>=</span><span class=s>&#34;400&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>canvas</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;</span><span class=nt>script</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text/javascript&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>		
</span></span><span class=line><span class=cl>		<span class=nb>window</span><span class=p>.</span><span class=nx>onload</span><span class=o>=</span><span class=kd>function</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>			<span class=kd>var</span> <span class=nx>clock</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s2>&#34;#clock&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>			<span class=k>if</span><span class=p>(</span><span class=nx>clock</span><span class=p>.</span><span class=nx>getContext</span><span class=p>){</span>
</span></span><span class=line><span class=cl>				<span class=kd>var</span> <span class=nx>ctx</span> <span class=o>=</span> <span class=nx>clock</span><span class=p>.</span><span class=nx>getContext</span><span class=p>(</span><span class=s2>&#34;2d&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>				<span class=nx>setInterval</span><span class=p>(</span><span class=kd>function</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>clearRect</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=nx>clock</span><span class=p>.</span><span class=nx>width</span><span class=p>,</span><span class=nx>clock</span><span class=p>.</span><span class=nx>height</span><span class=p>);</span>
</span></span><span class=line><span class=cl>					<span class=nx>move</span><span class=p>();</span>
</span></span><span class=line><span class=cl>				<span class=p>},</span><span class=mi>1000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>				
</span></span><span class=line><span class=cl>				<span class=nx>move</span><span class=p>();</span>
</span></span><span class=line><span class=cl>				<span class=kd>function</span> <span class=nx>move</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>save</span><span class=p>();</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>lineWidth</span> <span class=o>=</span> <span class=mi>8</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				  	<span class=nx>ctx</span><span class=p>.</span><span class=nx>strokeStyle</span> <span class=o>=</span> <span class=s2>&#34;black&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				  	<span class=nx>ctx</span><span class=p>.</span><span class=nx>lineCap</span> <span class=o>=</span> <span class=s2>&#34;round&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>translate</span><span class=p>(</span><span class=mi>200</span><span class=p>,</span><span class=mi>200</span><span class=p>);</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>scale</span><span class=p>(.</span><span class=mi>5</span><span class=p>,.</span><span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>rotate</span><span class=p>(</span><span class=o>-</span><span class=mi>90</span><span class=o>*</span><span class=nb>Math</span><span class=p>.</span><span class=nx>PI</span><span class=o>/</span><span class=mi>180</span><span class=p>);</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>beginPath</span><span class=p>();</span>
</span></span><span class=line><span class=cl>					
</span></span><span class=line><span class=cl>					<span class=c1>//外层空心圆盘
</span></span></span><span class=line><span class=cl><span class=c1></span>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>save</span><span class=p>();</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>strokeStyle</span><span class=o>=</span><span class=s2>&#34;#325FA2&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>lineWidth</span> <span class=o>=</span> <span class=mi>14</span><span class=p>;</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>beginPath</span><span class=p>();</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>arc</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>140</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>360</span><span class=o>*</span><span class=nb>Math</span><span class=p>.</span><span class=nx>PI</span><span class=o>/</span><span class=mi>180</span><span class=p>);</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>stroke</span><span class=p>();</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>restore</span><span class=p>();</span>
</span></span><span class=line><span class=cl>					
</span></span><span class=line><span class=cl>					
</span></span><span class=line><span class=cl>					<span class=c1>//时针刻度
</span></span></span><span class=line><span class=cl><span class=c1></span>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>save</span><span class=p>();</span>
</span></span><span class=line><span class=cl>					<span class=k>for</span><span class=p>(</span><span class=kd>var</span> <span class=nx>i</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span><span class=nx>i</span><span class=o>&lt;</span><span class=mi>12</span><span class=p>;</span><span class=nx>i</span><span class=o>++</span><span class=p>){</span>
</span></span><span class=line><span class=cl>						<span class=nx>ctx</span><span class=p>.</span><span class=nx>rotate</span><span class=p>(</span><span class=mi>30</span><span class=o>*</span><span class=nb>Math</span><span class=p>.</span><span class=nx>PI</span><span class=o>/</span><span class=mi>180</span><span class=p>);</span>
</span></span><span class=line><span class=cl>						<span class=nx>ctx</span><span class=p>.</span><span class=nx>beginPath</span><span class=p>();</span>
</span></span><span class=line><span class=cl>						<span class=nx>ctx</span><span class=p>.</span><span class=nx>moveTo</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>						<span class=nx>ctx</span><span class=p>.</span><span class=nx>lineTo</span><span class=p>(</span><span class=mi>120</span><span class=p>,</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>						<span class=nx>ctx</span><span class=p>.</span><span class=nx>stroke</span><span class=p>();</span>
</span></span><span class=line><span class=cl>					<span class=p>}</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>restore</span><span class=p>();</span>
</span></span><span class=line><span class=cl>					
</span></span><span class=line><span class=cl>					<span class=c1>//分针刻度
</span></span></span><span class=line><span class=cl><span class=c1></span>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>save</span><span class=p>();</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>lineWidth</span><span class=o>=</span><span class=mi>4</span><span class=p>;</span>
</span></span><span class=line><span class=cl>					<span class=k>for</span><span class=p>(</span><span class=kd>var</span> <span class=nx>i</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span><span class=nx>i</span><span class=o>&lt;</span><span class=mi>60</span><span class=p>;</span><span class=nx>i</span><span class=o>++</span><span class=p>){</span>
</span></span><span class=line><span class=cl>						<span class=nx>ctx</span><span class=p>.</span><span class=nx>rotate</span><span class=p>(</span><span class=mi>6</span><span class=o>*</span><span class=nb>Math</span><span class=p>.</span><span class=nx>PI</span><span class=o>/</span><span class=mi>180</span><span class=p>);</span>
</span></span><span class=line><span class=cl>						<span class=k>if</span><span class=p>((</span><span class=nx>i</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span><span class=o>%</span><span class=mi>5</span><span class=o>!=</span><span class=mi>0</span><span class=p>){</span>
</span></span><span class=line><span class=cl>							<span class=nx>ctx</span><span class=p>.</span><span class=nx>beginPath</span><span class=p>();</span>
</span></span><span class=line><span class=cl>							<span class=nx>ctx</span><span class=p>.</span><span class=nx>moveTo</span><span class=p>(</span><span class=mi>117</span><span class=p>,</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>							<span class=nx>ctx</span><span class=p>.</span><span class=nx>lineTo</span><span class=p>(</span><span class=mi>120</span><span class=p>,</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>							<span class=nx>ctx</span><span class=p>.</span><span class=nx>stroke</span><span class=p>();</span>
</span></span><span class=line><span class=cl>						<span class=p>}</span>
</span></span><span class=line><span class=cl>					<span class=p>}</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>restore</span><span class=p>();</span>
</span></span><span class=line><span class=cl>					
</span></span><span class=line><span class=cl>					<span class=c1>//时针 分针 秒针 表座
</span></span></span><span class=line><span class=cl><span class=c1></span>					<span class=kd>var</span> <span class=nx>date</span> <span class=o>=</span> <span class=k>new</span> <span class=nb>Date</span><span class=p>();</span>
</span></span><span class=line><span class=cl>					<span class=kd>var</span> <span class=nx>s</span> <span class=o>=</span> <span class=nx>date</span><span class=p>.</span><span class=nx>getSeconds</span><span class=p>();</span>
</span></span><span class=line><span class=cl>					<span class=kd>var</span> <span class=nx>m</span> <span class=o>=</span> <span class=nx>date</span><span class=p>.</span><span class=nx>getMinutes</span><span class=p>()</span><span class=o>+</span><span class=nx>s</span><span class=o>/</span><span class=mi>60</span><span class=p>;</span>
</span></span><span class=line><span class=cl>					<span class=kd>var</span> <span class=nx>h</span> <span class=o>=</span> <span class=nx>date</span><span class=p>.</span><span class=nx>getHours</span><span class=p>()</span><span class=o>+</span><span class=nx>m</span><span class=o>/</span><span class=mi>60</span><span class=p>;</span>
</span></span><span class=line><span class=cl>					<span class=nx>h</span> <span class=o>=</span> <span class=nx>h</span><span class=o>&gt;</span><span class=mi>12</span><span class=o>?</span><span class=nx>h</span><span class=o>-</span><span class=mi>12</span><span class=o>:</span><span class=nx>h</span><span class=p>;</span>
</span></span><span class=line><span class=cl>					
</span></span><span class=line><span class=cl>					<span class=c1>//时针
</span></span></span><span class=line><span class=cl><span class=c1></span>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>save</span><span class=p>()</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>lineWidth</span><span class=o>=</span><span class=mi>14</span><span class=p>;</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>rotate</span><span class=p>(</span><span class=nx>h</span><span class=o>*</span><span class=mi>30</span><span class=o>*</span><span class=nb>Math</span><span class=p>.</span><span class=nx>PI</span><span class=o>/</span><span class=mi>180</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>beginPath</span><span class=p>()</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>moveTo</span><span class=p>(</span><span class=o>-</span><span class=mi>20</span><span class=p>,</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>lineTo</span><span class=p>(</span><span class=mi>80</span><span class=p>,</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>stroke</span><span class=p>();</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>restore</span><span class=p>()</span>
</span></span><span class=line><span class=cl>					
</span></span><span class=line><span class=cl>					<span class=c1>//分针
</span></span></span><span class=line><span class=cl><span class=c1></span>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>save</span><span class=p>()</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>lineWidth</span><span class=o>=</span><span class=mi>10</span><span class=p>;</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>rotate</span><span class=p>(</span><span class=nx>m</span><span class=o>*</span><span class=mi>6</span><span class=o>*</span><span class=nb>Math</span><span class=p>.</span><span class=nx>PI</span><span class=o>/</span><span class=mi>180</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>beginPath</span><span class=p>()</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>moveTo</span><span class=p>(</span><span class=o>-</span><span class=mi>28</span><span class=p>,</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>lineTo</span><span class=p>(</span><span class=mi>112</span><span class=p>,</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>stroke</span><span class=p>();</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>restore</span><span class=p>()</span>
</span></span><span class=line><span class=cl>					
</span></span><span class=line><span class=cl>					
</span></span><span class=line><span class=cl>					<span class=c1>//秒针
</span></span></span><span class=line><span class=cl><span class=c1></span>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>save</span><span class=p>()</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>lineWidth</span><span class=o>=</span><span class=mi>6</span><span class=p>;</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>strokeStyle</span><span class=o>=</span><span class=s2>&#34;#D40000&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>fillStyle</span><span class=o>=</span><span class=s2>&#34;#D40000&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>rotate</span><span class=p>(</span><span class=nx>s</span><span class=o>*</span><span class=mi>6</span><span class=o>*</span><span class=nb>Math</span><span class=p>.</span><span class=nx>PI</span><span class=o>/</span><span class=mi>180</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>beginPath</span><span class=p>();</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>moveTo</span><span class=p>(</span><span class=o>-</span><span class=mi>30</span><span class=p>,</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>lineTo</span><span class=p>(</span><span class=mi>83</span><span class=p>,</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>stroke</span><span class=p>();</span>
</span></span><span class=line><span class=cl>						<span class=c1>//表座
</span></span></span><span class=line><span class=cl><span class=c1></span>						<span class=nx>ctx</span><span class=p>.</span><span class=nx>beginPath</span><span class=p>();</span>
</span></span><span class=line><span class=cl>						<span class=nx>ctx</span><span class=p>.</span><span class=nx>arc</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>10</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>360</span><span class=o>*</span><span class=nb>Math</span><span class=p>.</span><span class=nx>PI</span><span class=o>/</span><span class=mi>180</span><span class=p>);</span>
</span></span><span class=line><span class=cl>						<span class=nx>ctx</span><span class=p>.</span><span class=nx>fill</span><span class=p>();</span>
</span></span><span class=line><span class=cl>						<span class=c1>//秒头
</span></span></span><span class=line><span class=cl><span class=c1></span>						<span class=nx>ctx</span><span class=p>.</span><span class=nx>beginPath</span><span class=p>();</span>
</span></span><span class=line><span class=cl>						<span class=nx>ctx</span><span class=p>.</span><span class=nx>arc</span><span class=p>(</span><span class=mi>96</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>10</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>360</span><span class=o>*</span><span class=nb>Math</span><span class=p>.</span><span class=nx>PI</span><span class=o>/</span><span class=mi>180</span><span class=p>);</span>
</span></span><span class=line><span class=cl>						<span class=nx>ctx</span><span class=p>.</span><span class=nx>stroke</span><span class=p>();</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>restore</span><span class=p>()</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>restore</span><span class=p>();</span>
</span></span><span class=line><span class=cl>				<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>			
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><a href=#在canvas中插入图片><h1 id=在canvas中插入图片><span class=hanchor arialabel=Anchor># </span>在canvas中插入图片</h1></a><p>(需要image对象)</p><ol><li>canvas操作图片时，必须要等图片加载完才能操作</li><li>drawImage(image, x, y, width, height)<br>其中 image 是 image 或者 canvas 对象，x 和 y 是其在目标 canvas 里的起始坐标。<br>这个方法多了2个参数：width 和 height，这两个参数用来控制 当像canvas画入时应该缩放的大小。</li></ol><p>可以参考MDN文档了解img对象地各种属性</p><p><img src=https://jieye-ericx.github.io//20210410190610.png width=auto alt=image-20200311011503912></p><a href=#在canvas中设置背景><h1 id=在canvas中设置背景><span class=hanchor arialabel=Anchor># </span>在canvas中设置背景</h1></a><p>createPattern(image, repetition)</p><p>image:图像源<br>epetition:<br>&ldquo;repeat&rdquo;<br>&ldquo;repeat-x&rdquo;<br>&ldquo;repeat-y&rdquo;<br>&ldquo;no-repeat&rdquo;</p><p>一般情况下，我们都会将createPattern返回的对象作为fillstyle的值。</p><p><img src=https://jieye-ericx.github.io//20210410190617.png width=auto alt=image-20200311011708241></p><a href=#渐变><h2 id=渐变><span class=hanchor arialabel=Anchor># </span>渐变</h2></a><a href=#线性渐变><h3 id=线性渐变><span class=hanchor arialabel=Anchor># </span>线性渐变</h3></a><p><code>createLinearGradient(x1, y1, x2, y2)</code></p><ul><li>表示渐变的起点 (x1,y1) 与终点 (x2,y2)。</li></ul><p><code>gradient.addColorStop(position, color)</code></p><ul><li>gradient :createLinearGradient的返回值</li><li>addColorStop 方法接受 2 个参数:<ul><li>position 参数必须是一个 0.0 与 1.0 之间的数值，表示渐变中颜色所在的相对位置。例如，0.5 表示颜色会出现在正中间。</li><li>color 参数必须是一个有效的 CSS 颜色值（如#FFF ， rgba(0,0,0,1)，等等）</li></ul></li></ul><p><img src=https://jieye-ericx.github.io//20210410190625.png width=auto alt=image-20200311012227883></p><a href=#径向渐变><h3 id=径向渐变><span class=hanchor arialabel=Anchor># </span>径向渐变</h3></a><p><code>createRadialGradient(x1, y1, r1, x2, y2, r2)</code></p><ul><li>前三个参数则定义另一个以(x1,y1) 为原点，半径为 r1 的圆。</li><li>后三个参数则定义另一个以 (x2,y2) 为原点，半径为 r2 的圆。</li></ul><p><img src=https://jieye-ericx.github.io//20210410190631.png width=auto alt=image-20200311012406701></p><p><img src=https://jieye-ericx.github.io//20210410190634.png width=auto alt=image-20200311012533748></p><a href=#文本相关><h1 id=文本相关><span class=hanchor arialabel=Anchor># </span>文本相关</h1></a><a href=#绘制><h2 id=绘制><span class=hanchor arialabel=Anchor># </span>绘制</h2></a><p>canvas 提供了两种方法来渲染文本:</p><ul><li><code>fillText(text, x, y)</code>在指定的(x,y)位置填充指定文本</li><li><code>strokeText(text, x, y)</code>在指定的(x,y)位置绘制文本边框</li></ul><p>文本样式<br>font = value<br>当前我们用来绘制文本的样式. 这个字符串使用和 CSS font 属性相同的语法。<br>默认的字体是 10px sans-serif。font属性在指定时，必须要有大小和字体 缺一不可。</p><p><img src=https://jieye-ericx.github.io//20210410190744.png width=auto alt=image-20200311013532482></p><p><code>textAlign = value</code><br>文本对齐选项,可选的值包括： left, right center.</p><ul><li>left文本左对齐。</li><li>right文本右对齐。</li><li>center文本居中对齐。</li></ul><p>这里的textAlign=&ldquo;center"比较特殊。textAlign的值为center时候文本的居中是基于你在fillText的时候所给的x的值，也就是说文本一半在x的左边，一半在x的右边。</p><p><code>textBaseline = value</code><br>描述绘制文本时，当前文本基线的属性。</p><ul><li>top文本基线在文本块的顶部。</li><li>middle文本基线在文本块的中间。</li><li>bottom文本基线在文本块的底部。</li></ul><a href=#measuretext><h3 id=measuretext><span class=hanchor arialabel=Anchor># </span>measureText</h3></a><p>measureText() 方法返回一个 TextMetrics 对象，包含关于文本尺寸的信息（例如文本的宽度）</p><p><img src=https://jieye-ericx.github.io//20210410190758.png width=auto alt=image-20200311014220835></p><a href=#中文本水平垂直居中><h3 id=中文本水平垂直居中><span class=hanchor arialabel=Anchor># </span>中文本水平垂直居中</h3></a><p><img src=https://jieye-ericx.github.io//20210410190806.png width=auto alt=image-20200311014526376></p><a href=#文本阴影盒阴影><h3 id=文本阴影盒阴影><span class=hanchor arialabel=Anchor># </span>文本阴影&盒阴影</h3></a><p><img src=https://jieye-ericx.github.io//20210410190810.png width=auto alt=image-20200313001036182></p><p><img src=https://jieye-ericx.github.io//20210410190815.png width=auto alt=image-20200313001128434></p><a href=#像素相关><h1 id=像素相关><span class=hanchor arialabel=Anchor># </span>像素相关</h1></a><p>到目前为止，我们尚未深入了解Canvas画布真实像素的原理，事实上，你可以直接通过ImageData对象操纵像素数据，直接读取或将数据数组写入该对象中。</p><a href=#得到场景像素数据><h2 id=得到场景像素数据><span class=hanchor arialabel=Anchor># </span>得到场景像素数据</h2></a><p><code>getImageData()</code>:获得一个包含画布场景像素数据的<code>ImageData</code>对像,它代表了画布区域的对象数据。</p><p><code>ctx.getImageData(sx, sy, sw, sh)</code></p><ul><li>sx:将要被提取的图像数据矩形区域的左上角 x 坐标。</li><li>sy:将要被提取的图像数据矩形区域的左上角 y 坐标。</li><li>sw:将要被提取的图像数据矩形区域的宽度。</li><li>sh:将要被提取的图像数据矩形区域的高度。</li></ul><p><img src=https://jieye-ericx.github.io//20210410190818.png width=auto alt=image-20200313001713085></p><p><code>ImageData</code>对象中存储着<code>canvas</code>对象真实的像素数据，它包含以下几个只读属性：</p><ul><li>width:图片宽度，单位是像素</li><li>height:图片高度，单位是像素</li><li>data:Uint8ClampedArray类型的一维数组，<br>包含着RGBA格式的整型数据，范围在0至255之间（包括255）<ul><li>R:0 &ndash;> 255(黑色到白色)</li><li>G:0 &ndash;> 255(黑色到白色)</li><li>B:0 &ndash;> 255(黑色到白色)</li><li>A:0 &ndash;> 255(透明到不透明)</li></ul></li></ul><a href=#创建一个imagedata对象><h2 id=创建一个imagedata对象><span class=hanchor arialabel=Anchor># </span>创建一个<code>ImageData</code>对象</h2></a><p><code>ctx.createImageData(width, height);</code></p><ul><li>width : ImageData 新对象的宽度。</li><li>height: ImageData 新对象的高度。</li></ul><p><img src=https://jieye-ericx.github.io//20210410190827.png width=auto alt=image-20200313001646971></p><a href=#在场景中写入像素数据><h2 id=在场景中写入像素数据><span class=hanchor arialabel=Anchor># </span>在场景中写入像素数据</h2></a><p><code>putImageData()</code>方法去对场景进行像素数据的写入。<br><code>putImageData(myImageData, dx, dy)</code></p><ul><li>dx和dy 参数表示你希望在场景内左上角绘制的像素数据所得到的设备坐标</li></ul><a href=#操作单个像素行与列><h2 id=操作单个像素行与列><span class=hanchor arialabel=Anchor># </span>操作单个像素（行与列）</h2></a><p><img src=https://jieye-ericx.github.io//20210410190837.png width=auto alt=image-20200313002620658></p><p>两个操作函数,注意这里有老生常谈的xy计算问题。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>getPxInfo</span><span class=p>(</span><span class=nx>imgdata</span><span class=p>,</span> <span class=nx>x</span><span class=p>,</span> <span class=nx>y</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>color</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>data</span> <span class=o>=</span> <span class=nx>imgdata</span><span class=p>.</span><span class=nx>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>w</span> <span class=o>=</span> <span class=nx>imgdata</span><span class=p>.</span><span class=nx>width</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>h</span> <span class=o>=</span> <span class=nx>imgdata</span><span class=p>.</span><span class=nx>height</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=c1>//(x,y)  x*w+y
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=c1>//r
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>color</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=nx>data</span><span class=p>[(</span><span class=nx>y</span> <span class=o>*</span> <span class=nx>w</span> <span class=o>+</span> <span class=nx>x</span><span class=p>)</span> <span class=o>*</span> <span class=mi>4</span><span class=p>];</span>
</span></span><span class=line><span class=cl>	<span class=c1>//g
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>color</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=nx>data</span><span class=p>[(</span><span class=nx>y</span> <span class=o>*</span> <span class=nx>w</span> <span class=o>+</span> <span class=nx>x</span><span class=p>)</span> <span class=o>*</span> <span class=mi>4</span> <span class=o>+</span> <span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>	<span class=c1>//b
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>color</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=nx>data</span><span class=p>[(</span><span class=nx>y</span> <span class=o>*</span> <span class=nx>w</span> <span class=o>+</span> <span class=nx>x</span><span class=p>)</span> <span class=o>*</span> <span class=mi>4</span> <span class=o>+</span> <span class=mi>2</span><span class=p>];</span>
</span></span><span class=line><span class=cl>	<span class=c1>//a
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>color</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=nx>data</span><span class=p>[(</span><span class=nx>y</span> <span class=o>*</span> <span class=nx>w</span> <span class=o>+</span> <span class=nx>x</span><span class=p>)</span> <span class=o>*</span> <span class=mi>4</span> <span class=o>+</span> <span class=mi>3</span><span class=p>];</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>color</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>setPxInfo</span><span class=p>(</span><span class=nx>imgdata</span><span class=p>,</span> <span class=nx>x</span><span class=p>,</span> <span class=nx>y</span><span class=p>,</span> <span class=nx>color</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>data</span> <span class=o>=</span> <span class=nx>imgdata</span><span class=p>.</span><span class=nx>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>w</span> <span class=o>=</span> <span class=nx>imgdata</span><span class=p>.</span><span class=nx>width</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>h</span> <span class=o>=</span> <span class=nx>imgdata</span><span class=p>.</span><span class=nx>height</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=c1>//(x,y)  x*w+y   x:多少列  y：多少行
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=c1>//r
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>data</span><span class=p>[(</span><span class=nx>y</span> <span class=o>*</span> <span class=nx>w</span> <span class=o>+</span> <span class=nx>x</span><span class=p>)</span> <span class=o>*</span> <span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=nx>color</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>	<span class=c1>//g
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>data</span><span class=p>[(</span><span class=nx>y</span> <span class=o>*</span> <span class=nx>w</span> <span class=o>+</span> <span class=nx>x</span><span class=p>)</span> <span class=o>*</span> <span class=mi>4</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=nx>color</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>	<span class=c1>//b
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>data</span><span class=p>[(</span><span class=nx>y</span> <span class=o>*</span> <span class=nx>w</span> <span class=o>+</span> <span class=nx>x</span><span class=p>)</span> <span class=o>*</span> <span class=mi>4</span> <span class=o>+</span> <span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=nx>color</span><span class=p>[</span><span class=mi>2</span><span class=p>];</span>
</span></span><span class=line><span class=cl>	<span class=c1>//a
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>data</span><span class=p>[(</span><span class=nx>y</span> <span class=o>*</span> <span class=nx>w</span> <span class=o>+</span> <span class=nx>x</span><span class=p>)</span> <span class=o>*</span> <span class=mi>4</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=nx>color</span><span class=p>[</span><span class=mi>3</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><a href=#实践2-给图片打马赛克><h1 id=实践2-给图片打马赛克><span class=hanchor arialabel=Anchor># </span>实践2 给图片打马赛克</h1></a><p><img src=https://jieye-ericx.github.io//20210410190847.png width=auto alt=image-20200313005543527></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span><span class=lnt>93
</span><span class=lnt>94
</span><span class=lnt>95
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE html&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>		<span class=p>&lt;</span><span class=nt>meta</span> <span class=na>charset</span><span class=o>=</span><span class=s>&#34;UTF-8&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>		<span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>		<span class=p>&lt;</span><span class=nt>style</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text/css&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>			<span class=o>*</span><span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=k>margin</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=k>padding</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=nt>html</span><span class=o>,</span><span class=nt>body</span><span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=k>height</span><span class=p>:</span> <span class=mi>100</span><span class=kt>%</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=k>overflow</span><span class=p>:</span> <span class=kc>hidden</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=p>#</span><span class=nn>msk</span><span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=k>position</span><span class=p>:</span> <span class=kc>absolute</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=k>left</span><span class=p>:</span> <span class=mi>50</span><span class=kt>%</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=k>top</span><span class=p>:</span> <span class=mi>50</span><span class=kt>%</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=k>transform</span><span class=p>:</span> <span class=nb>translate3d</span><span class=p>(</span><span class=mi>-50</span><span class=kt>%</span><span class=p>,</span><span class=mi>-50</span><span class=kt>%</span><span class=p>,</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>				<span class=c>/*background: gray;*/</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			
</span></span><span class=line><span class=cl>		<span class=p>&lt;/</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>		<span class=p>&lt;</span><span class=nt>canvas</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;msk&#34;</span> <span class=p>&gt;&lt;/</span><span class=nt>canvas</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;</span><span class=nt>script</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text/javascript&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>		<span class=kd>var</span> <span class=nx>oc</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s2>&#34;#msk&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=k>if</span><span class=p>(</span><span class=nx>oc</span><span class=p>.</span><span class=nx>getContext</span><span class=p>){</span>
</span></span><span class=line><span class=cl>			<span class=kd>var</span> <span class=nx>ctx</span> <span class=o>=</span> <span class=nx>oc</span><span class=p>.</span><span class=nx>getContext</span><span class=p>(</span><span class=s2>&#34;2d&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>			<span class=kd>var</span> <span class=nx>img</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Image</span><span class=p>();</span>
</span></span><span class=line><span class=cl>			<span class=nx>img</span><span class=p>.</span><span class=nx>src</span><span class=o>=</span><span class=s2>&#34;2.png&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=nx>img</span><span class=p>.</span><span class=nx>onload</span><span class=o>=</span><span class=kd>function</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>				<span class=nx>oc</span><span class=p>.</span><span class=nx>width</span><span class=o>=</span><span class=nx>img</span><span class=p>.</span><span class=nx>width</span><span class=o>*</span><span class=mi>2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=nx>oc</span><span class=p>.</span><span class=nx>height</span><span class=o>=</span><span class=nx>img</span><span class=p>.</span><span class=nx>height</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=nx>draw</span><span class=p>();</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=kd>function</span> <span class=nx>draw</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>				<span class=nx>ctx</span><span class=p>.</span><span class=nx>drawImage</span><span class=p>(</span><span class=nx>img</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>				<span class=kd>var</span> <span class=nx>oldImgdata</span> <span class=o>=</span> <span class=nx>ctx</span><span class=p>.</span><span class=nx>getImageData</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=nx>img</span><span class=p>.</span><span class=nx>width</span><span class=p>,</span><span class=nx>img</span><span class=p>.</span><span class=nx>height</span><span class=p>);</span>
</span></span><span class=line><span class=cl>				<span class=kd>var</span> <span class=nx>newImgdata</span> <span class=o>=</span> <span class=nx>ctx</span><span class=p>.</span><span class=nx>createImageData</span><span class=p>(</span><span class=nx>img</span><span class=p>.</span><span class=nx>width</span><span class=p>,</span><span class=nx>img</span><span class=p>.</span><span class=nx>height</span><span class=p>);</span>
</span></span><span class=line><span class=cl>				<span class=c1>//马赛克
</span></span></span><span class=line><span class=cl><span class=c1></span>				<span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>					1.选取一个马赛克矩形
</span></span></span><span class=line><span class=cl><span class=cm>					2.从马赛克矩形中随机抽出一个像素点的信息(rgba)
</span></span></span><span class=line><span class=cl><span class=cm>					3.将整个马赛克矩形中的像素点信息统一调成随机抽出的那个
</span></span></span><span class=line><span class=cl><span class=cm>				*/</span>
</span></span><span class=line><span class=cl>				<span class=c1>//选取一个马赛克矩形
</span></span></span><span class=line><span class=cl><span class=c1></span>				<span class=kd>var</span> <span class=nx>size</span> <span class=o>=</span> <span class=mi>5</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=k>for</span><span class=p>(</span><span class=kd>var</span> <span class=nx>i</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span><span class=nx>i</span><span class=o>&lt;</span><span class=nx>oldImgdata</span><span class=p>.</span><span class=nx>width</span><span class=o>/</span><span class=nx>size</span><span class=p>;</span><span class=nx>i</span><span class=o>++</span><span class=p>){</span>
</span></span><span class=line><span class=cl>					<span class=k>for</span><span class=p>(</span><span class=kd>var</span> <span class=nx>j</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span><span class=nx>j</span><span class=o>&lt;</span><span class=nx>oldImgdata</span><span class=p>.</span><span class=nx>height</span><span class=o>/</span><span class=nx>size</span><span class=p>;</span><span class=nx>j</span><span class=o>++</span><span class=p>){</span>
</span></span><span class=line><span class=cl>						<span class=c1>//(i,j)  每一个马赛克矩形的坐标
</span></span></span><span class=line><span class=cl><span class=c1></span>						<span class=c1>//(0,0):  (0,0)  (4,4);[0,4]   //(1,0): (5,0) (9,4)
</span></span></span><span class=line><span class=cl><span class=c1></span>						<span class=c1>//(0,1):  (0,5)  (4,9)	 	   //(1,1): (5,5) (9,9)
</span></span></span><span class=line><span class=cl><span class=c1></span>						<span class=c1>//Math.random()  [0,1)
</span></span></span><span class=line><span class=cl><span class=c1></span>						<span class=c1>//Math.random()*size  [0,5)
</span></span></span><span class=line><span class=cl><span class=c1></span>						<span class=c1>//Math.floor(Math.random()*size) [0,4]
</span></span></span><span class=line><span class=cl><span class=c1></span>						<span class=c1>//从马赛克矩形中随机抽出一个像素点的信息(rgba)
</span></span></span><span class=line><span class=cl><span class=c1></span>						<span class=kd>var</span> <span class=nx>color</span> <span class=o>=</span> <span class=nx>getPxInfo</span><span class=p>(</span><span class=nx>oldImgdata</span><span class=p>,</span><span class=nx>i</span><span class=o>*</span><span class=nx>size</span><span class=o>+</span><span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>()</span><span class=o>*</span><span class=nx>size</span><span class=p>),</span><span class=nx>j</span><span class=o>*</span><span class=nx>size</span><span class=o>+</span><span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>()</span><span class=o>*</span><span class=nx>size</span><span class=p>));</span>
</span></span><span class=line><span class=cl>						
</span></span><span class=line><span class=cl>						<span class=c1>//将整个马赛克矩形中的像素点信息统一调成随机抽出的那个
</span></span></span><span class=line><span class=cl><span class=c1></span>						<span class=k>for</span><span class=p>(</span><span class=kd>var</span> <span class=nx>a</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span><span class=nx>a</span><span class=o>&lt;</span><span class=nx>size</span><span class=p>;</span><span class=nx>a</span><span class=o>++</span><span class=p>){</span>
</span></span><span class=line><span class=cl>							<span class=k>for</span><span class=p>(</span><span class=kd>var</span> <span class=nx>b</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span><span class=nx>b</span><span class=o>&lt;</span><span class=nx>size</span><span class=p>;</span><span class=nx>b</span><span class=o>++</span><span class=p>){</span>
</span></span><span class=line><span class=cl>								<span class=nx>setPxInfo</span><span class=p>(</span><span class=nx>newImgdata</span><span class=p>,</span><span class=nx>i</span><span class=o>*</span><span class=nx>size</span><span class=o>+</span><span class=nx>a</span><span class=p>,</span><span class=nx>j</span><span class=o>*</span><span class=nx>size</span><span class=o>+</span><span class=nx>b</span><span class=p>,</span><span class=nx>color</span><span class=p>)</span>
</span></span><span class=line><span class=cl>							<span class=p>}</span>
</span></span><span class=line><span class=cl>						<span class=p>}</span>
</span></span><span class=line><span class=cl>					<span class=p>}</span>
</span></span><span class=line><span class=cl>				<span class=p>}</span>
</span></span><span class=line><span class=cl>				<span class=c1>// ctx.clearRect(0,0,oc.width,oc.height);
</span></span></span><span class=line><span class=cl><span class=c1></span>				<span class=nx>ctx</span><span class=p>.</span><span class=nx>putImageData</span><span class=p>(</span><span class=nx>newImgdata</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=kd>function</span> <span class=nx>getPxInfo</span><span class=p>(</span><span class=nx>imgdata</span><span class=p>,</span><span class=nx>x</span><span class=p>,</span><span class=nx>y</span><span class=p>){</span>
</span></span><span class=line><span class=cl>				<span class=kd>var</span> <span class=nx>color</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>				<span class=kd>var</span> <span class=nx>data</span> <span class=o>=</span> <span class=nx>imgdata</span><span class=p>.</span><span class=nx>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=kd>var</span> <span class=nx>w</span> <span class=o>=</span> <span class=nx>imgdata</span><span class=p>.</span><span class=nx>width</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=kd>var</span> <span class=nx>h</span> <span class=o>=</span> <span class=nx>imgdata</span><span class=p>.</span><span class=nx>height</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=nx>color</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>=</span><span class=nx>data</span><span class=p>[(</span><span class=nx>y</span><span class=o>*</span><span class=nx>w</span><span class=o>+</span><span class=nx>x</span><span class=p>)</span><span class=o>*</span><span class=mi>4</span><span class=p>];</span>
</span></span><span class=line><span class=cl>				<span class=nx>color</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>=</span><span class=nx>data</span><span class=p>[(</span><span class=nx>y</span><span class=o>*</span><span class=nx>w</span><span class=o>+</span><span class=nx>x</span><span class=p>)</span><span class=o>*</span><span class=mi>4</span><span class=o>+</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>				<span class=nx>color</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>=</span><span class=nx>data</span><span class=p>[(</span><span class=nx>y</span><span class=o>*</span><span class=nx>w</span><span class=o>+</span><span class=nx>x</span><span class=p>)</span><span class=o>*</span><span class=mi>4</span><span class=o>+</span><span class=mi>2</span><span class=p>];</span>
</span></span><span class=line><span class=cl>				<span class=nx>color</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=o>=</span><span class=nx>data</span><span class=p>[(</span><span class=nx>y</span><span class=o>*</span><span class=nx>w</span><span class=o>+</span><span class=nx>x</span><span class=p>)</span><span class=o>*</span><span class=mi>4</span><span class=o>+</span><span class=mi>3</span><span class=p>];</span>
</span></span><span class=line><span class=cl>				<span class=k>return</span> <span class=nx>color</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=kd>function</span> <span class=nx>setPxInfo</span><span class=p>(</span><span class=nx>imgdata</span><span class=p>,</span><span class=nx>x</span><span class=p>,</span><span class=nx>y</span><span class=p>,</span><span class=nx>color</span><span class=p>){</span>
</span></span><span class=line><span class=cl>				<span class=kd>var</span> <span class=nx>data</span> <span class=o>=</span> <span class=nx>imgdata</span><span class=p>.</span><span class=nx>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=kd>var</span> <span class=nx>w</span> <span class=o>=</span> <span class=nx>imgdata</span><span class=p>.</span><span class=nx>width</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=kd>var</span> <span class=nx>h</span> <span class=o>=</span> <span class=nx>imgdata</span><span class=p>.</span><span class=nx>height</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=nx>data</span><span class=p>[(</span><span class=nx>y</span><span class=o>*</span><span class=nx>w</span><span class=o>+</span><span class=nx>x</span><span class=p>)</span><span class=o>*</span><span class=mi>4</span><span class=p>]</span><span class=o>=</span><span class=nx>color</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>				<span class=nx>data</span><span class=p>[(</span><span class=nx>y</span><span class=o>*</span><span class=nx>w</span><span class=o>+</span><span class=nx>x</span><span class=p>)</span><span class=o>*</span><span class=mi>4</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span><span class=o>=</span><span class=nx>color</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>				<span class=nx>data</span><span class=p>[(</span><span class=nx>y</span><span class=o>*</span><span class=nx>w</span><span class=o>+</span><span class=nx>x</span><span class=p>)</span><span class=o>*</span><span class=mi>4</span><span class=o>+</span><span class=mi>2</span><span class=p>]</span><span class=o>=</span><span class=nx>color</span><span class=p>[</span><span class=mi>2</span><span class=p>];</span>
</span></span><span class=line><span class=cl>				<span class=nx>data</span><span class=p>[(</span><span class=nx>y</span><span class=o>*</span><span class=nx>w</span><span class=o>+</span><span class=nx>x</span><span class=p>)</span><span class=o>*</span><span class=mi>4</span><span class=o>+</span><span class=mi>3</span><span class=p>]</span><span class=o>=</span><span class=nx>color</span><span class=p>[</span><span class=mi>3</span><span class=p>];</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><a href=#全局透明度><h1 id=全局透明度><span class=hanchor arialabel=Anchor># </span>全局透明度</h1></a><p><code>globalAlpha = value</code><br>这个属性影响到 canvas 里所有图形的透明度，有效的值范围是 0.0 （完全透明）到 1.0（完全不透明）,默认是 1.0。</p><p><img src=https://jieye-ericx.github.io//20210410190854.png width=auto alt=image-20200313010343599></p><a href=#合成><h1 id=合成><span class=hanchor arialabel=Anchor># </span>合成</h1></a><p><code>source</code>:新的图像(源)<br><code>destination</code>:已经绘制过的图形(目标)</p><p>globalCompositeOperation</p><ul><li><p>source-over(默认值):源在上面,新的图像层级比较高</p><p><img src=https://jieye-ericx.github.io//20210410190900.png width=auto alt=image-20200313010436866></p></li><li><p>source-in :只留下源与目标的重叠部分(源的那一部分)</p><p><img src=https://jieye-ericx.github.io//20210410190905.png width=auto alt=image-20200313010755439></p></li><li><p>source-out :只留下源超过目标的部分</p><p><img src=https://jieye-ericx.github.io//20210410190910.png width=auto alt=image-20200313010742501></p></li><li><p>source-atop:砍掉源溢出的部分</p><p><img src=https://jieye-ericx.github.io//20210410190917.png width=auto alt=image-20200313010725818></p></li><li><p>destination-over:目标在上面,旧的图像层级比较高</p><p><img src=https://jieye-ericx.github.io//20210410190922.png width=auto alt=image-20200313010659761></p></li><li><p>destination-in:只留下源与目标的重叠部分(目标的那一部分)</p><p><img src=https://jieye-ericx.github.io//20210410190927.png width=auto alt=image-20200313010640123></p></li><li><p>destination-out:只留下目标超过源的部分</p><p><img src=https://jieye-ericx.github.io//20210410190934.png width=auto alt=image-20200313010617596></p></li><li><p>destination-atop:砍掉目标溢出的部分</p><p><img src=https://jieye-ericx.github.io//20210410190938.png width=auto alt=image-20200313010551400></p></li></ul><a href=#实践3-刮刮卡><h1 id=实践3-刮刮卡><span class=hanchor arialabel=Anchor># </span>实践3 刮刮卡</h1></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE html&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;</span><span class=nt>meta</span> <span class=na>charset</span><span class=o>=</span><span class=s>&#34;UTF-8&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;</span><span class=nt>meta</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;viewport&#34;</span> <span class=na>content</span><span class=o>=</span><span class=s>&#34;width=device-width,initial-scale=1.0,user-scalable=no&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;/</span><span class=nt>meta</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;</span><span class=nt>style</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text/css&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>		<span class=o>*</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=k>margin</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=k>padding</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=nt>html</span><span class=o>,</span>
</span></span><span class=line><span class=cl>		<span class=nt>body</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=k>height</span><span class=p>:</span> <span class=mi>100</span><span class=kt>%</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=k>overflow</span><span class=p>:</span> <span class=kc>hidden</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=p>#</span><span class=nn>wrap</span><span class=o>,</span>
</span></span><span class=line><span class=cl>		<span class=nt>ul</span><span class=o>,</span>
</span></span><span class=line><span class=cl>		<span class=nt>ul</span><span class=o>&gt;</span><span class=nt>li</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=k>height</span><span class=p>:</span> <span class=mi>100</span><span class=kt>%</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=nt>ul</span><span class=o>&gt;</span><span class=nt>li</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=k>background</span><span class=p>:</span> <span class=nb>url</span><span class=p>(</span><span class=sx>img/b.png</span><span class=p>);</span>
</span></span><span class=line><span class=cl>			<span class=k>background-size</span><span class=p>:</span> <span class=mi>100</span><span class=kt>%</span> <span class=mi>100</span><span class=kt>%</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=nt>canvas</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=k>position</span><span class=p>:</span> <span class=kc>absolute</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=k>left</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=k>top</span><span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=k>transition</span><span class=p>:</span> <span class=mi>1</span><span class=kt>s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;/</span><span class=nt>style</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;</span><span class=nt>div</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;wrap&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>		<span class=p>&lt;</span><span class=nt>canvas</span><span class=p>&gt;&lt;/</span><span class=nt>canvas</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>		<span class=p>&lt;</span><span class=nt>ul</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>			<span class=p>&lt;</span><span class=nt>li</span><span class=p>&gt;&lt;/</span><span class=nt>li</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>		<span class=p>&lt;/</span><span class=nt>ul</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text/javascript&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nb>window</span><span class=p>.</span><span class=nx>onload</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=kd>var</span> <span class=nx>canvas</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s2>&#34;canvas&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=nx>canvas</span><span class=p>.</span><span class=nx>width</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>documentElement</span><span class=p>.</span><span class=nx>clientWidth</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		<span class=nx>canvas</span><span class=p>.</span><span class=nx>height</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>documentElement</span><span class=p>.</span><span class=nx>clientHeight</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		<span class=k>if</span> <span class=p>(</span><span class=nx>canvas</span><span class=p>.</span><span class=nx>getContext</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=kd>var</span> <span class=nx>ctx</span> <span class=o>=</span> <span class=nx>canvas</span><span class=p>.</span><span class=nx>getContext</span><span class=p>(</span><span class=s2>&#34;2d&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>			<span class=kd>var</span> <span class=nx>img</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Image</span><span class=p>();</span>
</span></span><span class=line><span class=cl>			<span class=nx>img</span><span class=p>.</span><span class=nx>src</span> <span class=o>=</span> <span class=s2>&#34;img/a.png&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=nx>img</span><span class=p>.</span><span class=nx>onload</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=nx>draw</span><span class=p>();</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=kd>function</span> <span class=nx>draw</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=kd>var</span> <span class=nx>flag</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=nx>ctx</span><span class=p>.</span><span class=nx>drawImage</span><span class=p>(</span><span class=nx>img</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>canvas</span><span class=p>.</span><span class=nx>width</span><span class=p>,</span> <span class=nx>canvas</span><span class=p>.</span><span class=nx>height</span><span class=p>);</span>
</span></span><span class=line><span class=cl>				<span class=nx>canvas</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&#34;touchstart&#34;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>ev</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>					<span class=nx>ev</span> <span class=o>=</span> <span class=nx>ev</span> <span class=o>||</span> <span class=nx>event</span><span class=p>;</span>
</span></span><span class=line><span class=cl>					<span class=kd>var</span> <span class=nx>touchC</span> <span class=o>=</span> <span class=nx>ev</span><span class=p>.</span><span class=nx>changedTouches</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>					<span class=kd>var</span> <span class=nx>x</span> <span class=o>=</span> <span class=nx>touchC</span><span class=p>.</span><span class=nx>clientX</span> <span class=o>-</span> <span class=nx>canvas</span><span class=p>.</span><span class=nx>offsetLeft</span><span class=p>;</span>
</span></span><span class=line><span class=cl>					<span class=kd>var</span> <span class=nx>y</span> <span class=o>=</span> <span class=nx>touchC</span><span class=p>.</span><span class=nx>clientY</span> <span class=o>-</span> <span class=nx>canvas</span><span class=p>.</span><span class=nx>offsetTop</span><span class=p>;</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>globalCompositeOperation</span> <span class=o>=</span> <span class=s2>&#34;destination-out&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>					<span class=c1>//这里用destination-out，则每点击一下，只留下原来的图像除了新点的位置的部分
</span></span></span><span class=line><span class=cl><span class=c1></span>					<span class=c1>//新点的也将消失，所以等价于每点一下则图片对应圆点消失，则只剩下背景。
</span></span></span><span class=line><span class=cl><span class=c1></span>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>lineWidth</span> <span class=o>=</span> <span class=mi>40</span><span class=p>;</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>lineCap</span> <span class=o>=</span> <span class=s2>&#34;round&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>lineJoin</span> <span class=o>=</span> <span class=s2>&#34;round&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>save</span><span class=p>();</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>beginPath</span><span class=p>();</span>
</span></span><span class=line><span class=cl>					<span class=c1>//						ctx.arc(x,y,20,0,360*Math.PI/180);
</span></span></span><span class=line><span class=cl><span class=c1></span>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>moveTo</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=nx>y</span><span class=p>);</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>lineTo</span><span class=p>(</span><span class=nx>x</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=nx>y</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>stroke</span><span class=p>();</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>restore</span><span class=p>();</span>
</span></span><span class=line><span class=cl>				<span class=p>})</span>
</span></span><span class=line><span class=cl>				<span class=nx>canvas</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&#34;touchmove&#34;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>ev</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>					<span class=nx>ev</span> <span class=o>=</span> <span class=nx>ev</span> <span class=o>||</span> <span class=nx>event</span><span class=p>;</span>
</span></span><span class=line><span class=cl>					<span class=kd>var</span> <span class=nx>touchC</span> <span class=o>=</span> <span class=nx>ev</span><span class=p>.</span><span class=nx>changedTouches</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>					<span class=kd>var</span> <span class=nx>x</span> <span class=o>=</span> <span class=nx>touchC</span><span class=p>.</span><span class=nx>clientX</span> <span class=o>-</span> <span class=nx>canvas</span><span class=p>.</span><span class=nx>offsetLeft</span><span class=p>;</span>
</span></span><span class=line><span class=cl>					<span class=kd>var</span> <span class=nx>y</span> <span class=o>=</span> <span class=nx>touchC</span><span class=p>.</span><span class=nx>clientY</span> <span class=o>-</span> <span class=nx>canvas</span><span class=p>.</span><span class=nx>offsetTop</span><span class=p>;</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>save</span><span class=p>();</span>
</span></span><span class=line><span class=cl>					<span class=c1>//						ctx.arc(x,y,20,0,360*Math.PI/180);
</span></span></span><span class=line><span class=cl><span class=c1></span>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>lineTo</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=nx>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>stroke</span><span class=p>();</span>
</span></span><span class=line><span class=cl>					<span class=nx>ctx</span><span class=p>.</span><span class=nx>restore</span><span class=p>();</span>
</span></span><span class=line><span class=cl>				<span class=p>})</span>
</span></span><span class=line><span class=cl>				<span class=nx>canvas</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&#34;touchend&#34;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>					<span class=kd>var</span> <span class=nx>imgData</span> <span class=o>=</span> <span class=nx>ctx</span><span class=p>.</span><span class=nx>getImageData</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>canvas</span><span class=p>.</span><span class=nx>width</span><span class=p>,</span> <span class=nx>canvas</span><span class=p>.</span><span class=nx>height</span><span class=p>)</span>
</span></span><span class=line><span class=cl>					<span class=kd>var</span> <span class=nx>allPx</span> <span class=o>=</span> <span class=nx>imgData</span><span class=p>.</span><span class=nx>width</span> <span class=o>*</span> <span class=nx>imgData</span><span class=p>.</span><span class=nx>height</span><span class=p>;</span>
</span></span><span class=line><span class=cl>					<span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=nx>allPx</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>						<span class=k>if</span> <span class=p>(</span><span class=nx>imgData</span><span class=p>.</span><span class=nx>data</span><span class=p>[</span><span class=mi>4</span> <span class=o>*</span> <span class=nx>i</span> <span class=o>+</span> <span class=mi>3</span><span class=p>]</span> <span class=o>===</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>							<span class=nx>flag</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>						<span class=p>}</span>
</span></span><span class=line><span class=cl>					<span class=p>}</span>
</span></span><span class=line><span class=cl>					<span class=k>if</span> <span class=p>(</span><span class=nx>flag</span> <span class=o>&gt;=</span> <span class=nx>allPx</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>						<span class=nx>canvas</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>opacity</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>					<span class=p>}</span>
</span></span><span class=line><span class=cl>				<span class=p>})</span>
</span></span><span class=line><span class=cl>				<span class=nx>canvas</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&#34;transitionend&#34;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>					<span class=k>this</span><span class=p>.</span><span class=nx>remove</span><span class=p>();</span>
</span></span><span class=line><span class=cl>				<span class=p>})</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><a href=#导出为图像><h1 id=导出为图像><span class=hanchor arialabel=Anchor># </span>导出为图像</h1></a><p>toDataURL(注意是canvas元素接口上的方法)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nb>window</span><span class=p>.</span><span class=nx>onload</span><span class=o>=</span><span class=kd>function</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>	<span class=c1>//querySelector身上有坑
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=c1>//拿到画布
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=kd>var</span> <span class=nx>canvas</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s2>&#34;#test&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span><span class=p>(</span><span class=nx>canvas</span><span class=p>.</span><span class=nx>getContext</span><span class=p>){</span>
</span></span><span class=line><span class=cl>		<span class=kd>var</span> <span class=nx>ctx</span> <span class=o>=</span> <span class=nx>canvas</span><span class=p>.</span><span class=nx>getContext</span><span class=p>(</span><span class=s2>&#34;2d&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=nx>ctx</span><span class=p>.</span><span class=nx>fillRect</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>199</span><span class=p>,</span><span class=mi>199</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=kd>var</span> <span class=nx>result</span> <span class=o>=</span>  <span class=nx>canvas</span><span class=p>.</span><span class=nx>toDataURL</span><span class=p>();</span>
</span></span><span class=line><span class=cl>		<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>result</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=https://jieye-ericx.github.io//20210410190947.png width=auto alt=image-20200313013610527></p><a href=#事件操作><h1 id=事件操作><span class=hanchor arialabel=Anchor># </span>事件操作</h1></a><p><code>ctx.isPointInPath(x, y)</code>判断在当前路径中是否包含检测点</p><ul><li>x:检测点的X坐标</li><li>y:检测点的Y坐标</li></ul><blockquote><p>注意！此方法只作用于最新一次性画出的canvas图像。</p></blockquote><p><img src=https://jieye-ericx.github.io//20210410190953.png width=auto alt=image-20200313014009126></p></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=/%E5%89%8D%E7%AB%AF/ data-ctx=Canvas data-src=/%E5%89%8D%E7%AB%AF class=internal-link>前端</a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://jieye-ericx.github.io/js/graph.6579af7b10c818dbd2ca038702db0224.js></script></div></div><div id=contact_buttons><footer><p>Made by Jieye ericx using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, © 2024</p><ul><li><a href=https://jieye-ericx.github.io/>Home</a></li><li><a href=https://github.com/jieye-ericx>Github</a></li></ul></footer></div></div></body></html>