<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="6-1 In our example transport primitives of Fig. 6-2, LISTEN is a blocking call. Is this strictly necessary? If not, explain how a nonblocking primitive could be used."><meta property="og:title" content><meta property="og:description" content="6-1 In our example transport primitives of Fig. 6-2, LISTEN is a blocking call. Is this strictly necessary? If not, explain how a nonblocking primitive could be used."><meta property="og:type" content="website"><meta property="og:image" content="https://jieye-ericx.github.io/icon.png"><meta property="og:url" content="https://jieye-ericx.github.io/%E8%AE%A1%E7%BD%91%E7%AC%AC%E5%85%AD%E7%AB%A0/"><meta property="og:width" content="200"><meta property="og:height" content="200"><meta name=twitter:card content="summary"><meta name=twitter:title content><meta name=twitter:description content="6-1 In our example transport primitives of Fig. 6-2, LISTEN is a blocking call. Is this strictly necessary? If not, explain how a nonblocking primitive could be used."><meta name=twitter:image content="https://jieye-ericx.github.io/icon.png"><title>ericx 's 数字花园</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://jieye-ericx.github.io//icon.png><link href=https://jieye-ericx.github.io/styles.80333fa2099c0bee674efa435fde378c.min.css rel=stylesheet><link href=https://jieye-ericx.github.io/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://jieye-ericx.github.io/js/darkmode.48459b7116d092b4e98d2cab704cad80.min.js></script>
<script src=https://jieye-ericx.github.io/js/util.00639692264b21bc3ee219733d38a8be.min.js></script>
<link rel=preload href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css as=style onload='this.onload=null,this.rel="stylesheet"' integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/@floating-ui/core@1.2.1></script>
<script src=https://cdn.jsdelivr.net/npm/@floating-ui/dom@1.2.1></script>
<script defer src=https://jieye-ericx.github.io/js/popover.aa9bc99c7c38d3ae9538f218f1416adb.min.js></script>
<script defer src=https://jieye-ericx.github.io/js/code-title.ce4a43f09239a9efb48fee342e8ef2df.min.js></script>
<script defer src=https://jieye-ericx.github.io/js/clipboard.2913da76d3cb21c5deaa4bae7da38c9f.min.js></script>
<script defer src=https://jieye-ericx.github.io/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const SEARCH_ENABLED=!1,LATEX_ENABLED=!0,PRODUCTION=!0,BASE_URL="https://jieye-ericx.github.io/",fetchData=Promise.all([fetch("https://jieye-ericx.github.io/indices/linkIndex.978b539fabc6a7a29a0ecd89a7f575a5.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://jieye-ericx.github.io/indices/contentIndex.e4f1617822572a37abb893fb2b9f5e7c.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://jieye-ericx.github.io",!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://jieye-ericx.github.io",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}var i=document.getElementsByClassName("mermaid");i.length>0&&import("https://unpkg.com/mermaid@9/dist/mermaid.esm.min.mjs").then(e=>{e.default.init()});function a(n){const e=n.target,t=e.className.split(" "),s=t.includes("broken"),o=t.includes("internal-link");plausible("Link Click",{props:{href:e.href,broken:s,internal:o,graph:!1}})}const r=document.querySelectorAll("a");for(link of r)link.className.includes("root-title")&&link.addEventListener("click",a,{once:!0})},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'’':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/jieye-ericx.github.io\/js\/router.d6fe6bd821db9ea97f9aeefae814d8e7.min.js"
    attachSPARouting(init, render)
  </script><script defer data-domain=jieye-ericx.github.io src=https://plausible.io/js/script.js></script>
<script>window.plausible=window.plausible||function(){(window.plausible.q=window.plausible.q||[]).push(arguments)}</script></head><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://jieye-ericx.github.io/js/full-text-search.e6e2e0c213187ca0c703d6e2c7a77fcd.min.js></script><div class=singlePage><header><h1 id=page-title><a class=root-title href=https://jieye-ericx.github.io/>ericx 's 数字花园</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><p class=meta>Last updated
Unknown
<a href=https://github.com/jackyzha0/quartz/tree/hugo/content/%e8%ae%a1%e7%bd%91%e7%ac%ac%e5%85%ad%e7%ab%a0.md rel=noopener>Edit Source</a></p><ul class=tags></ul><blockquote><p>6-1 In our example transport primitives of Fig. 6-2, LISTEN is a blocking call. Is this strictly necessary? If not, explain how a nonblocking primitive could be used. What advantage would this have over the scheme described in the text?</p><p><img src=https://jieye-ericx.github.io//../../pics/image-20211216134852148.png width=auto alt=image-20211216134852148></p></blockquote><img src=../../pics/image-20211228214102864.png alt=image-20211228214102864 style=zoom:25%><p>LISTEN阻塞调用并不是绝对必要的。可使用非阻塞的原语LISTEN，LISTEN调用可以表明建立新连接的意愿，但并非阻塞。当出现了建立连接的尝试时，可以给调用程序提供一个信号，然后它执行OK或REJECT来接受或拒绝连接。</p><p>阻塞LISTEN则缺乏这种灵活性。</p><blockquote><p>6-2 In the underlying model of Fig. 6-4, it is assumed that packets may be lost by the network layer and thus must be individually acknowledged. Suppose that the network layer is 100 percent reliable and never loses packets. What changes, if any, are needed to Fig. 6-4?</p><p>在图6-4的基础模型中，假设分组可能被网络层丢失，因此必须单独确认。假设网络层是100%可靠的，并且从不丢失数据包。需要对图6-4进行哪些更改（如有）？</p></blockquote><p>可以先回顾下为什么需要第三次握手，这主要是为了防止两次握手情况下已失效的连接请求报文段突然又传送到服务器而产生错误。</p><ol><li>客户 A 向服务器 B 发出 TCP 连接请求，第一个连接请求报文在网络的某个结点长时间滞留，A 超时后认为报文丢失。</li><li>A重传一次连接请求，B收到后建立连接。</li><li>数据传数完毕后双方断开连接。</li><li>前一个滞留在网络中的连接请求到达服务器B。</li></ol><ul><li>使用 “三次握手”，则B向A返回确认报文段，由于是一个失效的 请求，因此A不子理睬，建立连接失败。</li><li>若采用的是“两次握手”，则这种情况下 B认为传输连接己经建立，并一直等待 A 传输数据，而A 此时并无连接请求，因此不子理睬，这样就造成了B的资源白白浪费。</li></ul><p>如果网络层100%可靠，则被动的建立待定状态消失了,因为从被动建立到已建立的虚线不再取决于是否能收到对建立连接的确认。即因为客户机收到连接接收帧之后不必发送确认帧了，所以服务器可以在收到连接建立请求的时候就可以直接建立连接。</p><p>反映在图中为去掉 PASSIVE ESTABLISHMENT PENDING 状态到 ESTABLISH 的虚线和 PASSIVEDISCONNET PENDING 状态和 IDLE 状态的虚线，将两个操作变为立即执行原语操作，即图中的红框部分。</p><img src=../../pics/image-20211226211315006.png alt=image-20211226211315006 style=zoom:25%><blockquote><p>6-3 Why does the maximum packet lifetime, T, have to be large enough to ensure that not only the packet but also its acknowledgements have vanished?</p><p>6-3为什么最大数据包生存期T必须足够大，以确保数据包及其确认都消失了？</p></blockquote><ul><li>T若过小，导致接收方收到数据包但发送方没有收到ACK，从而导致发送方重复发送数据包，使得重复的数据包被引入网络造成资源的浪费。</li><li>T过小， 假设网络中有延迟的连接请求和确认应答，当第二个重复分组到达时，在网络中还存在着一个对老的序列号为Y的分组的确认，会产生一条无用的链接。</li></ul><blockquote><p>6-4 Discuss the advantages and disadvantages of credits versus sliding window protocols .</p></blockquote><p>实现简单；只需要管理较少的变量（一组窗口边缘）；不需要考虑窗口大小的问题，因为窗口的大小在任何情况都是提前设定的；对于授权：更加灵活，允许对缓存有动态管理相对于滑动窗口：授权独立于确认机制</p><blockquote><p>6-5 Why does UDP exist? Would it not have been enough to just let user processes send raw IP packets?</p><p>UDP为什么存在？仅仅让用户进程发送原始IP数据包还不够吗？</p></blockquote><p>不够，原因如下：</p><ol><li>UDP通过16位源端口号和16位目的端口号来实现应用程序间的区分（从点对点到端到端）</li><li>16位UDP校验和可以实现传输层的校验，虽然UDP协议不具备纠错能力，但是可以对出错的数据包进行丢弃。
IP协议只校验IP报头而不是整个数据包，整个数据包的校验是在传输层完成的。</li><li>传输层和网络层在操作系统内的实现层次不同，给用户开放的权限也不同，出于安全和易操作性的考虑，现代操作系统往往不允许/不建议普通用户直接操作IP协议。</li></ol><blockquote><p>6-6.Suppose that the TCP congestion window is set to 18 KB and a timeout occurs. How big will the window be if the next four transmission bursts are all successful? Assume that the maximum segment size is 1 KB.</p><p>假设TCP拥塞窗口设置为18 KB，并发生超时。如果接下来的四次传输突发都成功了，窗口会有多大？假设最大段大小为1 KB。</p></blockquote><p>当超时发生时启动<strong>慢开始</strong>，发送端的拥塞窗口cwnd重新设置为1,慢开始门限ssthresh=18/2=9。</p><p>接下来的4个RTT内，执行慢开始算法，每次的发送窗口大小为1，2，4，8，每次发送完成后但在下一次发送之前的发送窗口应该为2，4，8，16。第四次发送成功后，下一次的发送窗口本应为16，但由于慢开始门限=9的存在，故发送窗口设为9.（题目中说的是4次传输成功，所以可以认为发送窗口会发生更新）</p><p>注：为了加深每个RTT内活动的理解，这里我放了一张
<a href=https://www.bilibili.com/read/cv2429550 rel=noopener>参考图片</a></p><img src=../../pics/image-20211228232556729.png alt=image-20211228232556729 style=zoom:25%><blockquote><p>6-7. A TCP machine is sending full windows of 65,535 bytes over a 1-Gbps channel that has a 10-msec one-way delay. What is the maximum throughput achievable? What is the line efficiency?</p><p>TCP机器正在通过具有10毫秒单向延迟的1-Gbps通道发送65535字节的完整窗口。可达到的最大吞吐量是多少？线路效率是多少？</p></blockquote><ul><li>对于收到接收方的确认至少需要一个RTT,因此在一个RTT内发送的数据量不能超过发送窗口大小）
因此<code>最大吞吐率=一个RTT传输的有效数据/一个RTT的时间</code></li><li><code>线路效率=吞吐率/信道带宽</code></li></ul><p>$$
RTT=单向时延 \times2=20ms=0.02s \\ 吞吐率=\frac{65535\times 8\\ bit} {0.02s} = 26214000b/s= 26.214Mb/s \\ 线路效率=\frac{26.214Mb/s}{1000Mb/s} \times 100%=2.6214%
$$</p><blockquote><p>6-8 In a network whose max segment is 128 bytes, max segment lifetime is 30 sec, and has 8-bit sequence numbers, what is the maximum data rate per connection?</p><p>在最大段为128字节、最大段生存期为30秒且具有8位序列号的网络中，每个连接的最大数据速率是多少？</p></blockquote><p>具有相同编号的报文段不应同时在网络中传输，必须保证当序列号循环回来时重复使用时，具有相同序列号的报文段已从网络中消失，类似于GBN原理（$2^n-1$）. 现在序号用8位表示，报文段的寿命为30秒，那么在30秒的时间内发送方发送的报文段的数目不能多于255个。
$$
255 \times (128 \times 8 )/30 =8704b/s
$$</p><blockquote><p>6-9.A CPU executes instructions at the rate of 1000 MIPS. Data can be copied 64 bits at a time, with each word copied costing 10 instructions. If an coming packet has to be copied four times, can this system handle a 1-Gbps line? For simplicity, assume that all instructions, even those instructions that read or write memory, run at the full1000MIPS rate.</p><p>CPU以1000 MIPS的速率执行指令。数据一次可以复制64位，复制每个字需要花费10条指令。如果一个即将到来的数据包必须复制四次，这个系统能处理1-Gbps的线路吗？为简单起见，假设所有指令，即使是读或写内存的指令，都以full1000MIPS速率运行。</p></blockquote><p>$$
1000MIPS代表CPU执行一条指令的时间为\\ 1\\ ns\</p><p>复制一次64bit的数据需要10条指令，四次为40条，占用40ns\</p><p>一秒内可以处理的数据量为64bit \times (1s/40ns)=1.6 Gb\\ 故可以处理1Gb/s的线路
$$</p><blockquote><p>6-10 To get around the problem of sequence numbers wrapping around while old packets still exist, one could use 64-bit sequence numbers. However, theoretically, an optical fiber can run at 75 Tbps. What maximum packet lifetime is required to make sure that future 75-Tbps networks do not have wraparound problems even with 64-bit sequence numbers? Assume that each byte has its own sequence number, as TCP does.</p><p>为了解决旧数据包仍然存在时序列号环绕的问题，可以使用64位序列号。然而，理论上，光纤可以以75 Tbps的速率运行。要确保未来的75 Tbps网络即使使用64位序列号也不会出现环绕问题，需要多大的数据包生存期？假设每个字节都有自己的序列号，就像TCP一样。</p></blockquote><p>$$
光纤速率=75Tbps=7.5 \times 10^{13}\\ bps \\ 一秒钟发送的数据量=75 \times 10^{12}\\ bit =9.375 \times 10^{12}\\ B \\ 故每秒需要消耗9.375 \times 10^{12}个序号\\ 因为序号为64位，故在序号用完前可以发送\frac{2^{64}B}{9.375\times 10^{12}\\ B/s}=1967652 s\approx22.77d\\ 最好不要超过22天
$$</p></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li>No backlinks found</li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://jieye-ericx.github.io/js/graph.6579af7b10c818dbd2ca038702db0224.js></script></div></div><div id=contact_buttons><footer><p>Made by Jieye ericx using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, © 2023</p><ul><li><a href=https://jieye-ericx.github.io/>Home</a></li><li><a href=https://github.com/jieye-ericx>Github</a></li></ul></footer></div></div></body></html>